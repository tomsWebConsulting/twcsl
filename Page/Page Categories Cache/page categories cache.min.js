(()=>{
/*!
  
    page categories cache
    
    License       : < https://tinyurl.com/s872fb68 >
    
    Version       : 0.1.0
    
    SS Versions   : 7.1, 7.0
    
    v7.1
    Products V2
    Compatible    : Not Applicable
    
    v7.1
    Fluid
    Engine
    Compatible    : Not Applicable
    
    Notes         : this code makes a call to an unofficial Squarespace API
                    product content service products categories tree or
                    GetCollectionCategories for information that is not
                    normally available through other means
                    
                    the structure of the cache data is different between
                    v7.1 and v7.0. therefore your callbacks need to take
                    this into account
                    
                    the cache disable option doesn't disable the overall
                    cache logic. it simply removes the session storage key
                    after user callbacks are run. this causes the cache data
                    to be regenerated when the Store page is reloaded. this
                    can be useful for testing or if you want site visitors
                    to always have access to the current categories
    
    Copyright     : 2026 Thomas Creedon
                    
                    Tom's Web Consulting < http://www.tomsWeb.consulting/ >
    
    no user serviceable parts below
    
    */
const e="0.1.0",t=`\n    \n      Page Categories Cache v${e}\n      \n      License < https://tinyurl.com/s872fb68 >\n      \n      Â© 2026 Thomas Creedon\n      \n      Tom's Web Consulting < http://www.tomsWeb.consulting >\n      \n      `.replace(/^\s+/gm,"");console.log(t);const o=!!document.querySelectorAll(['body[ class*="collection-type-blog-" ]','body[ class~="collection-type-blog" ]'].join(", ")).length,c=!!document.querySelectorAll(['body[ class*="collection-type-events-" ]','body[ class~="collection-type-events" ]'].join(", ")).length,n=13===Static.SQUARESPACE_CONTEXT.collection?.type,s=o||c||n;if(!s)return;window.twc=window.twc||{},twc.pcc=twc.pcc||{},twc.pcc.callbacks=twc.pcc.callbacks||[];const a="twc-pcc",l=a.split("-").reduce((e,t)=>e?.[t],window),r=l.callbacks.length;if(!r){const e=`${a} no callbacks`;return void console.warn(e)}const i=Static.SQUARESPACE_CONTEXT.collection.id,p=async()=>{let e=sessionStorage.getItem(a);if(e)return e=JSON.parse(e),g(e),void(l.cacheDisable&&sessionStorage.removeItem(a));try{const t=await fetch(b);if(!t.ok){const e=`\n          \n            ${a} network response was not ok ${t.statusText}\n              \n            `.trim().replace(/\s+/gm," ");throw new Error(e)}e=await t.json(),y&&(e=e.categoryTree)}catch(e){const t=`\n          \n            ${a} there has been a problem with your fetch get\n            \n            operation, ${e}.\n            \n            `.trim().replace(/\s+/gm," ");console.error(t)}finally{const t=e=>{e.className=d(e[y?"displayName":m?"name":void 0])};e.forEach(t),sessionStorage.setItem(a,JSON.stringify(e)),g(e),l.cacheDisable&&sessionStorage.removeItem(a)}},d=e=>{if(!e)return;const t="category-"+e.replaceAll(" ","-").toLowerCase().replace(/[^\w-]+/g,"").replaceAll("--","-");return t},w=Static.SQUARESPACE_CONTEXT.templateVersion,g=e=>{const t=t=>{try{t(e)}catch(e){const t=`${a} callback error`;console.error(t,e)}};l.callbacks.forEach(t)},m="7"===w,y="7.1"===w,b=y?`/api/product-content-service/products/${i}/categories/tree`:m?`/api/commondata/GetCollectionCategories?collectionId=${i}`:void 0;b&&document.addEventListener("DOMContentLoaded",p)})();
