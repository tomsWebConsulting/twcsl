<!-- begin TWC Product Custom Form Text Field Max Length -->

  <!-- begin TWC Product Custom Form Text Field Max Length -->
  
    <!--
    
      begin product block form text field max length
      
      License         : < https://tinyurl.com/s872fb68 >
      
      Version         : 0.1.0
      
      SS Versions     : 7.1, 7.0
      
      v7.1
      Fluid
      Engine
      Compatible      : Yes
      
      v7.0 Templates  : Brine ( Aria, Blend, Burke, Cacao, Clay, Fairfield, Feed,
                        Foster, Greenwich, Hatch, Heights, Hunter, Hyde, Impact,
                        Jaunt, Juke, Keene, Kin, Lincoln, Maple, Margot, Marta,
                        Mentor, Mercer, Miller, Mojave, Moksha, Motto, Nueva, Pedro,
                        Pursuit, Rally, Rover, Royce, Sofia, Sonora, Stella, Thorne,
                        Vow, Wav, West )
                        
                        your template is not listed? then it is not currently
                        supported
      
      Dependencies    : product quick view form text field max length
      
                        product custom form text field max length
      
      Note            : this effect is not active in Squarespace Preview to test it
                        use private browsing < https://tinyurl.com/ynessvsf >
      
      By              : Thomas Creedon < http://www.tomsWeb.consulting/ >
      
      no user serviceable parts below
      
      -->
      
      <style>
      
        .collection-type-page .sqs-async-form-content .form-wrapper .field-list .field .field-element[ placeholder*="ftfml" ] {
        
          visibility : hidden;
          
          }
          
        </style>
        
      <script>
      
        ( ( ) => {
        
          const version = '0.1.0';
          
          const s = `Product Block Form Text Field Max Length v${ version }, ` +
          
            'License < https://tinyurl.com/s872fb68 >, ' +
            
            'Tom\'s Web Consulting < http://www.tomsWeb.consulting >';
            
          console.log ( s );
          
          if ( window.twc === undefined ) // initialize twc global if needed
          
            window.twc = { };
            
          if ( twc.ftfml === undefined ) // initialize ftfml if needed
          
            twc.ftfml = {
            
              ids : undefined,
              
              productIdSkuMap : { },
              
              response : undefined
              
              };
            
          } ) ( );
          
        document.addEventListener ( 'DOMContentLoaded', ( ) => {
        
          const callback = ( element ) => {
          
            const callback = function ( ) {
            
              const data = twc.ftfml;
              
              const itemId = this
                
                .getAttribute ( 'data-item-id' )
                
              const noSkuAttribute = `data-${ codeKey }-no-sku`;
              
              let b = this
              
                .getAttribute ( noSkuAttribute )
                
                !==
                
                null;
                
              data.ids = [ itemId ];
                
              if ( b ) { // bail if no sku
              
                data.response = Promise.resolve ( );
                
                return;
                
                }
                
              b = [
              
                '2' // digital
                
                ]
                
                .includes (
                
                  this
              
                  .getAttribute ( 'data-product-type' )
                  
                  );
                  
              if ( b ) { // bail if no sku
              
                this
                
                  .setAttribute ( noSkuAttribute, '' );
                  
                data.response = Promise.resolve ( );
                
                return;
                
                }
                
              const skuAttribute = `data-${ codeKey }-sku`;
              
              let sku = this
              
                .getAttribute ( skuAttribute );
                
              if ( sku === null ) {
              
                const variantsElement = this
                
                  .closest ( '.productDetails' )
                  
                  .querySelector ( '.product-variants' );
                  
                if ( variantsElement !== null ) {
                
                  sku = variantsElement
                    
                    .getAttribute ( 'data-selected-variant' );
                    
                  if ( sku === null ) return; // bail of no variant selected
                  
                  sku = JSON
                  
                    .parse ( sku )
                    
                    .sku;
                    
                  data
                    
                    .ids
                    
                    .push ( sku );
                    
                  data.response = Promise.resolve ( );
                  
                  } else {
                  
                    const callback = ( data ) => {
                      
                      sku = data
                      
                        .item
                        
                        .variants
                        
                        [ 0 ]
                        
                        .sku;
                        
                      this
                      
                        .setAttribute ( skuAttribute, sku );
                        
                      twc
                      
                        .ftfml
                        
                        .productIdSkuMap
                        
                        [ itemId ]
                        
                        =
                        
                        sku;
                        
                      twc
                      
                        .ftfml
                        
                        .ids
                        
                        .push ( sku );
                        
                      };
                      
                    const url = this
                    
                      .closest ( '.productDetails ' )
                      
                      .querySelector ( 'a' )
                      
                      .getAttribute ( 'href' )
                      
                      +
                      
                      '?format=json';
                      
                    data.response = fetch ( url )
                    
                      .then ( response => response.json ( ) )
                      
                      .then ( callback );
                        
                    }
                    
                }
                
              }
              
            const isSoldOut = element
            
              .closest ( '.product-block' )
              
              .querySelector ( '.image-container .product-mark.sold-out' )
              
              !==
              
              null;
              
            if ( isSoldOut ) return; // bail if sold out
            
            element
            
              .addEventListener ( 'click', callback )
              
            };
            
          const codeKey = 'twc-pbftfml';
          
          const selector = '.sqs-block-product .sqs-add-to-cart-button';
          
          document
            
            .querySelectorAll ( selector )
            
            .forEach ( callback );
            
          } );
          
        </script>
        
      <!-- end product block form text field max length -->
    
    <!--
    
      begin store page form text field max length
      
      License         : < https://tinyurl.com/s872fb68 >
      
      Version         : 0.3.2
      
      SS Versions     : 7.1, 7.0
      
      v7.1
      Fluid
      Engine
      Compatible      : Not Applicable
      
      v7.0 Templates  : Brine ( Aria, Blend, Burke, Cacao, Clay, Fairfield, Feed,
                        Foster, Greenwich, Hatch, Heights, Hunter, Hyde, Impact,
                        Jaunt, Juke, Keene, Kin, Lincoln, Maple, Margot, Marta,
                        Mentor, Mercer, Miller, Mojave, Moksha, Motto, Nueva, Pedro,
                        Pursuit, Rally, Rover, Royce, Sofia, Sonora, Stella, Thorne,
                        Vow, Wav, West )
                        
                        your template is not listed? then it is not currently
                        supported
      
      By              : Thomas Creedon < http://www.tomsWeb.consulting/ >
      
      no user serviceable parts below
      
      -->
      
      <script>
      
        ( ( ) => {
        
          const version = '0.3.2';
          
          const s = `Store Page Form Text Field Max Length v${ version }, ` +
          
            'License < https://tinyurl.com/s872fb68 >, ' +
            
            'Tom\'s Web Consulting < http://www.tomsWeb.consulting >';
            
          console.log ( s );
          
          } ) ( );
          
        document.addEventListener ( 'DOMContentLoaded', ( ) => {
        
          const selector = 'body';
          
          const b = ! document
          
            .querySelector ( selector )
            
            .classList
            
            .contains ( 'collection-type-products' );
            
          if ( b ) return; // bail if not store page
          
          const codeKey = `twc-spftfml`;
          
          const detail = ( ) => {
          
            const callback = ( element ) => {
            
              const callback = function ( ) {
              
                const data = twc.ftfml;
                
                const context = Static
                
                  .SQUARESPACE_CONTEXT;
                  
                data.ids = [
                
                  context
                  
                    .itemId
                    
                  ];
                  
                const variants = context
                
                  .product
                  
                  .variants;
                  
                if ( variants === undefined ) { // bail if no variants
                
                  data.response = Promise.resolve ( );
                  
                  return;
                  
                  }
                  
                if ( variants.length == 1 ) {
                
                  data
                  
                    .ids
                    
                    .push ( variants [ 0 ].sku )
                    
                  data.response = Promise.resolve ( );
                  
                  } else {
                  
                    let dataSelectedVariant = this
                    
                      .closest (
                      
                        [
                        
                          // begin 7.1
                          
                            '.ProductItem-details-checkout', // simple layout
                            
                            '.product-details', // full, half, wrap layout
                            
                            // end 7.1
                            
                          '.ProductItem-details' // 7.0 Brine
                          
                          ]
                          
                          .join ( ', ' )
                          
                        )
                      
                      .querySelector ( '.product-variants' );
                    
                    // bail if no variants
                    
                    if ( dataSelectedVariant === null ) return;
                    
                    dataSelectedVariant = dataSelectedVariant
                    
                      .getAttribute ( 'data-selected-variant' );
                      
                    // bail if no variant selected
                    
                    if ( dataSelectedVariant === undefined ) return;
                    
                    const sku = JSON
                    
                      .parse ( dataSelectedVariant )
                      
                      .sku;
                      
                    data
                    
                      .ids
                      
                      .push ( sku );
                      
                    data.response = Promise.resolve ( );
                    
                    }
                    
                }
                
              element
              
                .addEventListener ( 'click', callback );
                
              };
              
            const selector = [
            
              '.ProductItem', // simple layout
              
              '.pdp-layout' // full, half, wrap layout
              
              ]
              
              .map ( l => `${ l }:not( .sold-out ) ` +
              
                '.sqs-add-to-cart-button-wrapper ' +
                
                '.sqs-add-to-cart-button.use-form' )
                
              .join ( ', ' );
              
            document
            
              .querySelectorAll ( selector )
              
              .forEach ( callback );
            
            };
            
          const list = ( ) => {
          
            const callback = ( data ) => {
              
              const callback = ( item ) => {
              
                let b = item.additionalFieldsFormId === undefined;
                
                if ( b ) return; // bail if no form
                
                const selector = '.sqs-add-to-cart-button[ ' +
                
                  `data-item-id="${ item.id }"]`;
                  
                const element = document
                
                  .querySelector ( selector );
                  
                if ( element === null ) return; // bail if no element
                
                const callback = function ( ) {
                
                  const data = twc.ftfml;
                  
                  const itemId = this
                  
                    .getAttribute ( 'data-item-id' )
                    
                  const noSku = this
                  
                    .getAttribute ( noSkuAttribute )
                    
                    !==
                    
                    null;
                    
                  data.ids = [ itemId ];
                  
                  if ( noSku ) { // bail if no sku
                  
                    data.response = Promise.resolve ( );
                    
                    return;
                    
                    }
                    
                  let sku = this
                  
                    .getAttribute ( `data-${ codeKey }-sku` );
                    
                  if ( sku !== null ) { // bail if sku
                  
                    data.ids.push ( sku );
                    
                    data.response = Promise.resolve ( );
                    
                    return;
                    
                    }
                    
                  let variant = this
                  
                    .closest ( '.plp-grid-add-to-cart' )
                    
                    .querySelector ( '.product-variants' )
                    
                    .getAttribute ( 'data-selected-variant' );
                    
                  if ( variant === null ) return; // bail if no selected variants
                  
                  variant = JSON.parse ( variant );
                  
                  data
                  
                    .ids
                    
                    .push ( variant.sku );
                    
                  data.response = Promise.resolve ( );
                  
                  }
                  
                const noSkuAttribute = `data-${ codeKey }-no-sku`;
                
                const variants = item.variants;
                
                const l = variants.length;
                
                if ( ! l )
                
                  element
                  
                    .setAttribute ( noSkuAttribute, '' );
                    
                  else if ( l == 1 ) {
                  
                    const variant = variants [ 0 ];
                    
                    const b = ! variant.unlimited && ! variant.qtyInStock;
                    
                    if ( b ) return; // bail no stock
                    
                    const sku = variant.sku;
                    
                    element
                    
                      .setAttribute ( `data-${ codeKey }-sku`, sku );
                      
                    }
                    
                element
                
                  .addEventListener ( 'click', callback );
                  
                };
                
              data
              
                .items
                
                .forEach ( callback );
                
              };
              
            const url = location
            
              .pathname
              
              +
              
              '?format=json';
              
            fetch ( url )
            
              .then ( response => response.json ( ) )
              
              .then ( callback );
                
            };
            
          if ( window.twc === undefined ) // initialize twc global if needed
          
            window.twc = { };
            
          if ( twc.ftfml === undefined ) // initialize ftfml if needed
          
            twc.ftfml = {
            
              ids : undefined,
              
              productIdSkuMap : { },
              
              response : undefined
              
              };
              
          const isDetail = ( ( ) => {
          
            const selector = 'body[ id^="item-" ]';
            
            const is = document
            
              .querySelector ( selector )
              
              !==
              
              null;
              
            return is;
            
            } ) ( );
            
          const isList = ( ( ) => {
          
            const selector = 'body[ id^="collection-" ]';
            
            const is = document
            
              .querySelector ( selector )
              
              !==
              
              null;
              
            return is;
            
            } ) ( );
            
          switch ( true ) {
          
            case isDetail:
            
              detail ( );
              
              break;
              
            case isList:
            
              list ( );
              
              break;
              
            }
            
          } );
          
        </script>
        
      <!-- end store page form text field max length -->
    
    <!--
    
      begin product custom form text field max length
      
      License         : < https://tinyurl.com/s872fb68 >
      
      Version         : 0.1.0
      
      SS Versions     : 7.1, 7.0
      
      v7.1
      Fluid
      Engine
      Compatible      : Not Applicable
      
      v7.0 Templates  : Brine ( Aria, Blend, Burke, Cacao, Clay, Fairfield, Feed,
                        Foster, Greenwich, Hatch, Heights, Hunter, Hyde, Impact,
                        Jaunt, Juke, Keene, Kin, Lincoln, Maple, Margot, Marta,
                        Mentor, Mercer, Miller, Mojave, Moksha, Motto, Nueva, Pedro,
                        Pursuit, Rally, Rover, Royce, Sofia, Sonora, Stella, Thorne,
                        Vow, Wav, West )
                        
                        your template is not listed? then it is not currently
                        supported
      
      Dependencies    : modal lightbox observe changes
                        
                        product quick view form text field max length
      
      By              : Thomas Creedon < http://www.tomsWeb.consulting/ >
      
      no user serviceable parts below
      
      -->
      
      <style>
      
        .sqs-async-form-content .form-wrapper .field-list .field .field-element[ placeholder*="ftfml" ] {
        
          visibility : hidden;
          
          }
          
        </style>
        
      <script>
      
        ( ( ) => {
        
          const title = 'Product Custom Form Text Field Max Length';
          
          const version = '0.1.0';
          
          const s = `${ title } v${ version }, ` +
          
            'License < https://tinyurl.com/s872fb68 >, ' +
            
            'Tom\'s Web Consulting < http://www.tomsWeb.consulting >';
            
          console.log ( s );
          
          } ) ( );
          
        var twcPcftfml = ( node ) => {
        
          const codeKeySuffix = 'pcftfml';
          
          const codeKey = `twc-${ codeKeySuffix }`;
          
          const selector = '.form-wrapper input[ placeholder*="ftfml" ]';
          
          const elements = node
          
            .querySelectorAll ( selector );
            
          if ( ! elements.length ) return; // bail if no elements
          
          const callback = ( ) => {
          
            const callback = ( element ) => {
            
              const attribute = 'placeholder';
              
              const re = /^ftfml\s*:\s*{([^}]+)}\s*/;
              
              let text = element
              
                .getAttribute ( attribute );
                
              let m = text.match ( re );
              
              // begin clean up placeholder attribute value
              
                text = text
                
                  .replace ( m [ 0 ], '' )
                  
                  .trim ( );
                  
                if ( text ) // set/show placeholder or remove
                
                  element
                  
                    .setAttribute ( attribute, text );
                    
                  else
                  
                    element.removeAttribute ( attribute );
                    
                // end clean up placeholder attribute value
                
              let maxLength = m [ 1 ]
              
                .trim ( );
                
              if ( isNaN ( maxLength ) ) {
              
                const callback = ( key ) => {
                
                  const b = ! twc
                  
                    .ftfml
                    
                    .ids
                    
                    .includes ( key );
                    
                  if ( b ) return; // bail if no key
                  
                  maxLength = idMaxlengthMap [ key ];
                  
                  };
                  
                const json = '{' +
                
                  maxLength
                  
                    .replace ( /[\s]/g, '' )
                    
                    .split ( ',' )
                    
                    .map ( s => s.replace ( /([^:]+)/, '"$1"' ) )
                    
                    .join ( ',' ) +
                    
                  '}';
                  
                const key = 'default';
                
                const idMaxlengthMap = JSON.parse ( json );
                
                maxLength = '';
                
                if ( key in idMaxlengthMap )
                
                  maxLength = idMaxlengthMap [ key ];
                  
                Object
                
                  .keys ( idMaxlengthMap )
                  
                  .forEach ( callback );
                  
                }
                
              if ( maxLength )
              
                element
                
                  .setAttribute ( 'maxlength', maxLength );
                  
              };
              
            elements.forEach ( callback );
            
            };
            
          twc
          
            .ftfml
            
            .response
            
            .finally ( callback );
            
          };
          
        </script>
        
      <!-- end product custom form text field max length -->
    
    <!--
    
      begin product quick view form text field max length
      
      License         : < https://tinyurl.com/s872fb68 >
      
      Version         : 0.1.0
      
      SS Versions     : 7.1, 7.0
      
      v7.1
      Fluid
      Engine
      Compatible      : Not Applicable
      
      v7.0 Templates  : Brine ( Aria, Blend, Burke, Cacao, Clay, Fairfield, Feed,
                        Foster, Greenwich, Hatch, Heights, Hunter, Hyde, Impact,
                        Jaunt, Juke, Keene, Kin, Lincoln, Maple, Margot, Marta,
                        Mentor, Mercer, Miller, Mojave, Moksha, Motto, Nueva, Pedro,
                        Pursuit, Rally, Rover, Royce, Sofia, Sonora, Stella, Thorne,
                        Vow, Wav, West )
                        
                        your template is not listed? then it is not currently
                        supported
      
      Dependencies    : product quick view observe changes
      
      Note            : this effect is not active in Squarespace Preview to test it
                        use private browsing < https://tinyurl.com/ynessvsf >
      
      By              : Thomas Creedon < http://www.tomsWeb.consulting/ >
      
      no user serviceable parts below
      
      -->
      
      <script>
      
        ( ( ) => {
        
          const title = 'Product Quick View Form Text Field Max Length';
          
          const version = '0.1.0';
          
          const s = `${ title } v${ version }, ` +
          
            'License < https://tinyurl.com/s872fb68 >, ' +
            
            'Tom\'s Web Consulting < http://www.tomsWeb.consulting >';
            
          console.log ( s );
          
          } ) ( );
          
        var twcPqvftfml = ( element ) => {
        
          const codeKeySuffix = 'pqvftfml';
          
          const codeKey = `twc-${ codeKeySuffix }`;
          
          const callback = function ( ) {
          
            const b = [
            
              '2' // digital
              
              ]
              
              .includes (
              
                this
            
                .getAttribute ( 'data-product-type' )
                
                );
                
            const data = twc.ftfml;
            
            const itemId = this
            
              .getAttribute ( 'data-item-id' );
              
            data.ids = [ itemId ];
            
            if ( b ) return; // bail if no sku
            
            let sku = data.productIdSkuMap [ itemId ];
            
            const detailsSelector = [
                  
              '.ProductItem-details-checkout', // 7.1
              
              '.ProductItem-details' // 7.0
              
              ]
              
              .join ( ', ' );
              
            if ( sku === undefined ) {
            
              const variantsElement = this
              
                .closest ( detailsSelector )
                
                .querySelector ( '.product-variants' );
                
              if ( variantsElement !== null ) {
              
                sku = variantsElement
                  
                  .getAttribute ( 'data-selected-variant' );
                  
                if ( sku === null ) return; // bail of no variant selected
                
                sku = JSON
                
                  .parse ( sku )
                  
                  .sku;
                  
                data.ids.push ( sku );
                
                data.response = Promise.resolve ( );
                
                } else {
                
                  const url = this
                  
                    .closest ( detailsSelector )
                    
                    .querySelector ( 'a' )
                    
                    .getAttribute ( 'href' )
                    
                    +
                    
                    '?format=json';
                    
                  data.response = fetch ( url )
                  
                    .then ( response => response.json ( ) )
                    
                    .then ( data => {
                    
                      sku = data
                      
                        .item
                        
                        .variants
                        
                        [ 0 ]
                        
                        .sku;
                        
                      twc
                      
                        .ftfml
                        
                        .productIdSkuMap
                        
                        [ itemId ]
                        
                        =
                        
                        sku;
                        
                      twc
                      
                        .ftfml
                        
                        .ids
                        
                        .push ( sku );
                        
                      } );
                      
                  }
                  
              }
              
            }
            
          const selector = '.ProductItem:not( .sold-out ) ' +
          
            '.sqs-add-to-cart-button-wrapper ' +
            
            '.sqs-add-to-cart-button.use-form';
            
          if ( window.twc === undefined ) // initialize twc global if needed
          
            window.twc = { };
            
          if ( twc.ftfml === undefined ) // initialize ftfml if needed
          
            twc.ftfml = {
            
              ids : undefined,
              
              productIdSkuMap : { },
              
              response : undefined
              
              };
              
          element = element
            
            .querySelector ( selector );
            
          if ( element === null ) return; // bail if no element
          
          element
          
            .addEventListener ( 'click', callback );
            
          };
          
        </script>
        
      <!-- end product quick view form text field max length -->
    
    <!-- begin TWC Product Quick View Observe Changes -->
    
      <!--
      
        product quick view observe changes
        
        License       : < https://tinyurl.com/s872fb68 >
        
        Version       : 0.2.0
        
        SS Versions   : 7.1, 7.0
        
        v7.1
        Products V2
        Compatible    : Yes
        
        v7.1
        Fluid
        Engine
        Compatible    : Not Applicable
        
        Dependencies  : modal lightbox observe changes
                        
                        < https://tinyurl.com/2pfvaeud >
        
        Note          : this code is a base for other effects. on its own it doesn't
                        do anything. this code is not the end all be all of mutation
                        observers. it may not cover your needs
        
        Copyright     : 2024-2025 Thomas Creedon
                        
                        Tom's Web Consulting < http://www.tomsWeb.consulting/ >
        
        no user serviceable parts below
        
        -->
        
      <script>
      
        ( ( ) => {
        
          const
          
            version = '0.2.0',
            
            s = `Product Quick View Observe Changes v${ version }
            
              License < https://tinyurl.com/s872fb68 >
              
              Â© 2024-2025 Thomas Creedon
              
              Tom's Web Consulting < http://www.tomsWeb.consulting >`
              
              .replace ( /^\s+/gm, '' );
              
          console.log ( s );
          
          // globals
          
          {
          
            // initialize twc module
            
            window.twc = ( ( self ) => self ) ( window.twc || { } );
            
            // initialize twc pqvoc sub-module
            
            twc.pqvoc = ( ( self ) => self ) ( twc.pqvoc || { } );
            
            // initialize twc pqvoc callbacks sub-module
            
            twc.pqvoc.callbacks =
            
              ( ( self ) => self ) ( twc.pqvoc.callbacks || [ ] );
              
            }
            
          } ) ( );
          
        var twcPqvoc = ( node ) => {
        
          const isQuickView = node
          
            .classList
            
            .contains ( 'sqs-product-quick-view-lightbox' );
            
          if ( ! isQuickView ) return; // bail if no product quick view
          
          const
          
            callback = ( mutations ) => {
            
              const callback = ( mutation ) => {
              
                let hasAdded = mutation.addedNodes.length;
                
                if ( ! hasAdded ) return; // continue
                
                const
                
                  element = mutation
                  
                    .addedNodes
                    
                    [ 0 ],
                    
                  isProduct = [
                  
                    'product-detail', // 7.1
                    
                    'ProductItem' // 7.0
                    
                    ]
                    
                    .some ( c => element.classList.contains ( c ) );
                    
                if ( ! isProduct ) return; // bail if not product item
                
                const callback = ( callback ) => {
                
                  try {
                  
                    callback = window [ callback ];
                    
                    callback ( element );
                    
                    } catch ( error ) {
                    
                      const s = `${ codeKey } callback error`;
                      
                      console.error ( s, error );
                      
                      }
                      
                  };
                  
                options
                
                  .callbacks
                  
                  .forEach ( callback );
                  
                };
                
              mutations.forEach ( callback );
              
              },
              
            codeKey = 'twc-pqvoc',
            
            config = {
            
              childList : true
              
              },
              
            observer = new MutationObserver ( callback ),
            
            options = codeKey
            
              .split ( '-' )
              
              .reduce ( ( obj, key ) => obj?.[ key ], window ),
              
            selector = '.sqs-product-quick-view-content',
            
            element = node
            
              .querySelector ( selector );
              
          // start listening for changes in element
          
          observer.observe ( element, config );
          
          };
          
        </script>
        
      <!-- end TWC Product Quick View Observe Changes -->
    
    <!--
    
      begin modal lightbox observe changes
      
      License       : < https://tinyurl.com/s872fb68 >
      
      Version       : 0.1.1
      
      SS Versions   : 7.1, 7.0
      
      v7.1
      Fluid
      Engine
      Compatible    : Not Applicable
      
      Note          : this code is a base for other effects. on its own it
                      doesn't do anything. this code is not the end all be all
                      of mutation observers. it may not cover your needs
      
      By            : Thomas Creedon < http://www.tomsWeb.consulting/ >
      
      -->
      
      <script>
        
        if ( window.twc == undefined ) window.twc = { };
        
        twc.mloc = {
        
          callbacks : [
          
            /*
            
              following is an example line. copy and paste it after the example
              line. remove the double forward slash space of the new line. replace
              the name with your callback
              
              */
              
            // '[ enter your callback name here replacing square brackets ]',
            
            'twcPqvoc',
            
            'twcPcftfml',
            
            ]
            
          };
          
        </script>
        
      <!-- do not change anything below, there be the borg here -->
      
      <script>
      
        document.addEventListener ( 'DOMContentLoaded', ( ) => {
        
          const version = '0.1.1';
          
          const s = `Modal Lightbox Observe Changes v${ version }, ` +
          
            'License < https://tinyurl.com/s872fb68 >, ' +
            
            'Tom\'s Web Consulting < http://www.tomsWeb.consulting >';
            
          console.log ( s );
          
          const callback = ( mutations ) => {
          
            const callback = ( mutation ) => {
            
              const callback = ( node ) => {
              
                const b = ! node
                
                  .classList
                  
                  .contains ( 'sqs-modal-lightbox' );
                  
                if ( b ) return; // bail if not element of interest
                
                const callback = ( callback ) => {
                
                  try {
                  
                    callback = window [ callback ];
                    
                    callback ( node );
                    
                    } catch ( error ) {
                    
                      const s = `${ codeKey } callback error`;
                      
                      console.error ( s, error );
                      
                      }
                      
                  };
                  
                twc
                
                  [ codeKeySuffix ]
                  
                  .callbacks
                  
                  .forEach ( callback );
                  
                };
                
              mutation
              
                .addedNodes
                
                .forEach ( callback );
                
              };
              
            mutations.forEach ( callback );
            
            };
            
          const codeKeySuffix = 'mloc';
          
          const codeKey = `twc-${ codeKeySuffix }`;
          
          const config = {
          
            childList : true
            
            };
            
          const observer = new MutationObserver ( callback );
          
          // start listening for changes in body
          
          observer.observe ( document.body, config );
          
          } );
          
        </script>
        
      <!-- end modal lightbox observe changes -->
    
    <!--
    
      begin cart page form text field max length
      
      License       : < https://tinyurl.com/s872fb68 >
      
      Version       : 0.1.1
      
      SS Versions   : 7.1, 7.0
      
      v7.1
      Fluid
      Engine
      Compatible    : Not Applicable
      
      Dependencies  : cart page observe changes
      
      Note          : this effect is not active in Squarespace Preview to test it
                      use private browsing < https://tinyurl.com/ynessvsf >
      
      By            : Thomas Creedon < http://www.tomsWeb.consulting/ >
      
      no user serviceable parts below
      
      -->
      
      <style>
      
        html:not( .squarespace-damask ) #sqs-cart-container .cart-product-form-wrapper input[ placeholder*="ftfml" ] {
        
          visibility : hidden;
          
          }
          
        </style>
        
      <script>
      
        ( ( ) => {
        
          const version = '0.1.1';
          
          const s = `Cart Page Form Text Field Max Length v${ version }, ` +
          
            'License < https://tinyurl.com/s872fb68 >, ' +
            
            'Tom\'s Web Consulting < http://www.tomsWeb.consulting >';
            
          console.log ( s );
          
          // initialize twc global if needed
          
          if ( window.twc == undefined ) window.twc = { };
          
          twc.cpftfml = {
          
            ids : undefined
            
            };
            
          } ) ( );
          
        var twcCpftfml = ( node ) => {
        
          let b = node.querySelector === undefined;
          
          if ( b ) return; // bail if no querySelector
          
          // cart container
          
          ( ( ) => {
          
            let selector = '.cart-container';
            
            const cartContainerElement = node
            
              .querySelector ( selector );
              
            if ( cartContainerElement === null ) return; // bail if no element
            
            const callback = ( element ) => {
            
              const callback = ( event ) => {
              
                console.log ( event );
                
                const i = [
                
                  ...
                  
                  cartRowElements
                  
                  ]
                  
                  .indexOf (
                  
                    element
                    
                      .closest ( '.cart-row' )
                      
                    );
                  
                const selector = '#sqs-cart-root script[type="application/json"]';
                
                // begin items
                
                  const callback = ( item ) => {
                  
                    console.log ( item );
                    
                    const b = ! ( 'productForm' in item );
                    
                    if ( b ) return [ ]; // bail if no product form
                    
                    const ids = [ item.productId ];
                    
                    if ( item.sku !== undefined )
                    
                      ids.push ( item.sku );
                      
                    return ids;
                    
                    };
                    
                  let items = document
                  
                    .querySelector ( selector )
                    
                    .textContent;
                    
                  items = JSON
                  
                    .parse ( items )
                    
                    .cart
                    
                    .items;
                    
                  // end items
                  
                const ids = items.map ( callback );
                
                twc.cpftfml.ids = ids [ i ];
                
                };
                
              element.addEventListener ( 'click', callback );
              
              };
              
            selector = '.cart-row';
            
            const cartRowElements = cartContainerElement
            
              .querySelectorAll ( selector );
              
            selector = '.cart-row-edit';
            
            cartContainerElement
            
              .querySelectorAll ( selector )
              
              .forEach ( callback );
              
            } ) ( );
            
          // cart product form container
          
          ( ( ) => {
          
            let selector = '.cart-product-form-container';
            
            let elements = node
            
              .querySelector ( selector );
              
            if ( elements === null ) return; // bail if no element
            
            const callback = ( element ) => {
            
              const attribute = 'placeholder';
              
              const re = /^ftfml\s*:\s*{([^}]+)}\s*/;
              
              let text = element
              
                .getAttribute ( attribute );
                
              let m = text.match ( re );
              
              // begin clean up placeholder attribute value
              
                text = text
                
                  .replace ( m [ 0 ], '' )
                  
                  .trim ( );
                  
                if ( text ) // set/show placeholder or remove
                
                  element
                  
                    .setAttribute ( attribute, text );
                    
                  else
                  
                    element.removeAttribute ( attribute );
                    
                // end clean up placeholder attribute value
                
              let maxLength = m [ 1 ]
              
                .trim ( );
                
              if ( isNaN ( maxLength ) ) {
              
                const callback = ( key ) => {
                
                  const b = ! twc
                  
                    .cpftfml
                    
                    .ids
                    
                    .includes ( key );
                    
                  if ( b ) return; // bail if no key
                  
                  maxLength = idMaxlengthMap [ key ];
                  
                  };
                  
                const json = '{' +
                
                  maxLength
                  
                    .replace ( /[\s]/g, '' )
                    
                    .split ( ',' )
                    
                    .map ( s => s.replace ( /([^:]+)/, '"$1"' ) )
                    
                    .join ( ',' ) +
                    
                  '}';
                  
                const key = 'default';
                
                const idMaxlengthMap = JSON.parse ( json );
                
                maxLength = '';
                
                if ( key in idMaxlengthMap )
                
                  maxLength = idMaxlengthMap [ key ];
                  
                Object
                
                  .keys ( idMaxlengthMap )
                  
                  .forEach ( callback );
                  
                }
                
              if ( maxLength )
              
                element
                
                  .setAttribute ( 'maxlength', maxLength );
                  
              };
              
            selector = '.cart-product-form-field-label ' +
            
              'input[ placeholder*="ftfml" ]';
              
            elements = elements
            
              .querySelectorAll ( selector )
              
              .forEach ( callback );
              
            } ) ( );
            
          };
          
        </script>
        
      <!-- end cart page form text field max length -->
    
    <script>
    
      document.addEventListener ( 'DOMContentLoaded', ( ) => {
      
        /*
        
          cart page observe changes
          
          License       : < https://tinyurl.com/s872fb68 >
          
          Version       : 0.2.2
          
          SS Versions   : 7.1, 7.0
          
          v7.1
          Fluid
          Engine
          Compatible    : Not Applicable
          
          Note          : this code is a base for other effects. on its own it
                          doesn't do anything. this code is not the end all be all
                          of mutation observers. it may not cover your needs
          
          By            : Thomas Creedon < http://www.tomsWeb.consulting/ >
          
          */
          
        const callbacks = {
        
          added : [
          
            /*
            
              following is an example line. copy and paste it after the example
              line. remove the double forward slash space of the new line. replace
              the name with your callback
              
              */
              
            // '[ optional, enter your callback name here replacing square brackets ]',
            
            'twcCpftfml',
            
            ],
            
          removed : [
          
            /*
            
              following is an example line. copy and paste it after the example
              line. remove the double forward slash space of the new line. replace
              the name with your callback
              
              */
              
            // '[ optional, enter your callback name here replacing square brackets ]',
            
            ]
            
          };
          
        // do not change anything below, there be the borg here
        
        const version = '0.2.2';
        
        const s = `Cart Page Observe Changes v${ version }, ` +
        
          'License < https://tinyurl.com/s872fb68 >, ' +
          
          'Tom\'s Web Consulting < http://www.tomsWeb.consulting >';
          
        console.log ( s );
        
        let b = location.pathname != '/cart';
        
        if ( b ) return; // bail if not cart page
        
        b = ! ( 'MutationObserver' in window );
        
        if ( b ) return; // bail if no mutation observer available
        
        const callback = ( mutations ) => {
        
          const callback = ( mutation ) => {
          
            const callback = ( node ) => {
            
              const callback = ( callback ) => {
              
                const cllbck = window [ callback ];
                
                try {
                
                  cllbck ( node );
                  
                  } catch ( error ) {
                  
                    const s = `${ codeKey } : ${ callback } `;
                    
                    console.error ( s, error );
                    
                    }
                    
                };
                
              cllbcks.forEach ( callback );
                
              };
              
            const nodesAdded = mutation.addedNodes;
            
            const nodesRemoved = mutation.removedNodes;
            
            let cllbcks;
            
            let nodes;
            
            switch ( true ) {
            
              case Boolean ( nodesAdded.length ):
              
                cllbcks = callbacks.added;
                
                nodes = nodesAdded
                
                break;
                
              case Boolean ( nodesRemoved.length ) :
              
                cllbcks = callbacks.removed;
                
                nodes = nodesRemoved;
                
                break;
                
              }
              
            nodes.forEach ( callback );
            
            };
            
          mutations.forEach ( callback );
          
          };
          
        const codeKey = 'twc-cpoc';
        
        const observer = new MutationObserver ( callback );
          
        const element = document
        
          .getElementById ( 'sqs-cart-container' );
          
        const options = {
        
          childList : true,
          
          subtree : true
          
          };
          
        // begin listening for changes in element
        
        observer.observe ( element, options );
          
        } );
        
      </script>
    <!-- begin TWC Product Block Form Text Field Max Length -->
    
      <!--
      
        product block form text field max length
        
        License         : < https://tinyurl.com/s872fb68 >
        
        Version         : 0.1.1
        
        SS Versions     : 7.1, 7.0
        
        v7.1
        Fluid
        Engine
        Compatible      : Yes
        
        v7.0 Templates  : Brine ( Aria, Blend, Burke, Cacao, Clay, Fairfield, Feed,
                          Foster, Greenwich, Hatch, Heights, Hunter, Hyde, Impact,
                          Jaunt, Juke, Keene, Kin, Lincoln, Maple, Margot, Marta,
                          Mentor, Mercer, Miller, Mojave, Moksha, Motto, Nueva,
                          Pedro, Pursuit, Rally, Rover, Royce, Sofia, Sonora,
                          Stella, Thorne, Vow, Wav, West )
                          
                          your template is not listed? then it is not currently
                          supported
        
        Dependencies    : product quick view form text field max length
                          
                          product custom form text field max length
        
        Notes           : this code does not work on the checkout page. it is a
                          Squarespace security feature that no code can alter the
                          checkout page
                          
                          this code is client side and making use of an HTML form
                          feature. Since this code is client side it is possible to
                          bypass the max length limit this code is setting. in other
                          words you still need to be checking manually when forms or
                          orders come in to make sure your limits are not being
                          exceeded. consider this code more of an aid to help users
                          not exceed your field max length limits
        
        Copyright       : 2024-2025 Thomas Creedon
                          
                          Tom's Web Consulting < http://www.tomsWeb.consulting/ >
        
        no user serviceable parts below
        
        -->
        
      <style>
      
        .collection-type-page .sqs-async-form-content .form-wrapper .field-list .field .field-element[ placeholder*="ftfml" ] {
        
          visibility : hidden;
          
          }
          
        </style>
        
      <script>
      
        ( ( ) => {
        
          const
          
            version = '0.1.1',
            
            s = `Product Block Form Text Field Max Length v${ version }
            
              License < https://tinyurl.com/s872fb68 >
              
              Â© 2024-2025 Thomas Creedon
              
              Tom's Web Consulting < http://www.tomsWeb.consulting >`
              
              .replace ( /^\s+/gm, '' );
              
          console.log ( s );
          
          const callback = ( ) => {
          
            // globals
            
            {
            
              // initialize twc module
              
              window.twc = ( ( self ) => self ) ( window.twc || { } );
              
              // initialize twc ftfml sub-module
              
              twc.ftfml = ( ( self ) => {
              
                const options = {
                
                  ids : undefined,
                  
                  response : undefined
                  
                  };
                  
                Object
                
                  .assign (
                  
                    self,
                    
                    options
                    
                    );
                    
                return self;
                
                } ) ( twc.ftfml || { } );
                
              }
              
            const
            
              codeKey = 'twc-pbftfml',
              
              handleEvent = ( event ) => {
              
                const
                
                  data = twc.ftfml,
                  
                  element = event
                  
                    .currentTarget,
                    
                  detailsElement = element
                  
                    .closest ( '.productDetails' ),
                    
                  setAttributes = ( ) => {
                  
                    const callback = ( element ) => {
                    
                      attributes
                      
                        [
                        
                          element
                          
                            .getAttribute ( 'name' )
                            
                          ]
                          
                        =
                        
                        element
                        
                          .value;
                          
                      };
                      
                    variantElements
                    
                      .forEach ( callback );
                      
                    },
                    
                  setVariantSku = ( ) => {
                  
                    sku = variants [
                    
                      JSON
                      
                        .stringify (
                        
                          attributes
                          
                          )
                          
                      ];
                      
                    },
                    
                  variantElements
                  
                    =
                    
                    detailsElement
                    
                      .querySelectorAll ( '.product-variants select' ),
                      
                  isVariantSelected
                  
                    =
                    
                    variantElements
                    
                      .length
                      
                    &&
                    
                    !
                    
                    [
                    
                      ...
                      
                      variantElements
                      
                      ]
                    
                      .filter ( e => ! e.value )
                      
                      .length;
                      
                let
                
                  attributes = { },
                  
                  itemId,
                  
                  sku,
                  
                  variants;
                  
                data.ids = [ ];
                
                if ( element.twcPbftfml ) {
                
                  const p = element.twcPbftfml;
                  
                  itemId = p.itemId;
                  
                  variants = p.variants;
                  
                  const l = variants
                  
                    &&
                    
                    Object
                    
                      .keys ( variants )
                      
                      .length;
                      
                  switch ( true ) {
                  
                    case ! variants :
                    
                      break;
                      
                    case l === 1 :
                    
                      sku = variants [ '{}' ];
                      
                      break;
                      
                    case l > 1 : {
                    
                      if ( isVariantSelected ) {
                      
                        setAttributes ( );
                        
                        setVariantSku ( );
                        
                        }
                        
                      break;
                      
                      }
                      
                    }
                    
                  data.ids.push (
                  
                    ...
                    
                    [ p.itemId, sku ]
                    
                      .filter ( e => e )
                      
                    );
                    
                  data.response = Promise.resolve ( );
                  
                  } else {
                  
                    const url = detailsElement
                    
                      .querySelector ( '.product-title' )
                      
                      .getAttribute ( 'href' )
                      
                      +
                      
                      '?format=json';
                      
                    data.response = fetch ( url )
                    
                      .then ( ( response ) => {
                      
                        if ( ! response.ok ) {
                        
                          const s = `
                          
                            ${ codeKey } network response was not ok ${
                            
                              response
                                
                                .statusText
                                
                                }
                                
                            `
                            
                            .trim ( )
                            
                            .replace ( /\s+/gm, ' ' );
                            
                          throw new Error ( s );
                          
                          }
                          
                        const obj = response.json ( );
                        
                        return obj;
                        
                        } )
                        
                      .then ( ( obj ) => {
                      
                        const
                        
                          item = obj.item,
                          
                          l = item.variants.length;
                          
                        itemId = item.id;
                        
                        if ( l ) {
                        
                          const callback = ( variant ) => {
                          
                            const optionOrdering
                            
                              =
                              
                              item
                              
                                .variantOptionOrdering;
                                
                            let obj = { };
                            
                            if ( optionOrdering.length )
                            
                              obj = optionOrdering
                              
                                .reduce ( ( acc, key ) => {
                                
                                  if ( key in variant.attributes )
                                  
                                    acc [ key ] = variant.attributes [ key ];
                                    
                                  return acc;
                                  
                                  }, { } );
                                  
                            variants [
                            
                              JSON.stringify ( obj )
                              
                              ]
                              
                              =
                              
                              variant
                              
                                .sku;
                                
                            };
                            
                          variants = { };
                          
                          item
                          
                            .variants
                            
                            .forEach ( callback );
                            
                          }
                          
                        switch ( true ) {
                        
                          case ! variants :
                          
                            break;
                            
                          case l === 1 :
                          
                            sku = variants [ '{}' ];
                            
                            break;
                            
                          case l > 1 : {
                          
                            if ( isVariantSelected ) {
                            
                              setAttributes ( );
                              
                              setVariantSku ( );
                              
                              }
                              
                            break;
                            
                            }
                            
                          }
                          
                        data.ids.push (
                        
                          ...
                          
                          [ itemId, sku ]
                          
                            .filter ( e => e )
                            
                          );
                          
                        element.twcPbftfml = {
                        
                          itemId : itemId,
                          
                          variants : variants
                          
                          };
                          
                        } );
                        
                    }
                    
                },
                
              selector = '.sqs-block[ data-definition-name="'
              
                +
                
                'website.components.product" ]:not( :has( .product-block '
                
                +
                
                '.image-container .product-mark.sold-out ) ) '
                
                +
                
                '.sqs-add-to-cart-button-wrapper';
                
            document
            
              .querySelectorAll ( selector )
              
              .forEach ( e =>
              
                e.addEventListener ( 'click', handleEvent )
                
                );
                
            };
            
          document.addEventListener ( 'DOMContentLoaded', callback );
          
          } ) ( );
          
        </script>
        
      <!-- end TWC Product Block Form Text Field Max Length -->
    
    <!-- begin TWC Store Page Form Text Field Max Length -->
    
      <!--
      
        store page form text field max length
        
        License         : < https://tinyurl.com/s872fb68 >
        
        Version         : 0.3.3
        
        SS Versions     : 7.1, 7.0
        
        v7.1
        Products V2
        Compatible      : Yes
        
        v7.1
        Fluid
        Engine
        Compatible      : Not Applicable
        
        v7.0 Templates  : Brine ( Aria, Blend, Burke, Cacao, Clay, Fairfield, Feed,
                          Foster, Greenwich, Hatch, Heights, Hunter, Hyde, Impact,
                          Jaunt, Juke, Keene, Kin, Lincoln, Maple, Margot, Marta,
                          Mentor, Mercer, Miller, Mojave, Moksha, Motto, Nueva,
                          Pedro, Pursuit, Rally, Rover, Royce, Sofia, Sonora,
                          Stella, Thorne, Vow, Wav, West )
                          
                          your template is not listed? then it is not currently
                          supported
        
        Dependencies    : product custom form text field max length
        
        Notes           : this code does not work on the checkout page. it is a
                          Squarespace security feature that no code can alter the
                          checkout page
                          
                          this code is client side and making use of an HTML form
                          feature. Since this code is client side it is possible to
                          bypass the max length limit this code is setting. in other
                          words you still need to be checking manually when forms or
                          orders come in to make sure your limits are not being
                          exceeded. consider this code more of an aid to help users
                          not exceed your field max length limits
        
        Copyright       : 2024-2025 Thomas Creedon
                          
                          Tom's Web Consulting < http://www.tomsWeb.consulting/ >
        
        no user serviceable parts below
        
        -->
        
        <script>
        
          ( ( ) => {
          
            const
            
              version = '0.3.3',
              
              s = `Store Page Form Text Field Max Length v${ version }
              
                License < https://tinyurl.com/s872fb68 >
                
                Â© 2024-2025 Thomas Creedon
                
                Tom's Web Consulting < http://www.tomsWeb.consulting >`
                
                .replace ( /^\s+/gm, '' );
                
            console.log ( s );
            
            const callback = ( ) => {
            
              const isStorePage = Static
              
                .SQUARESPACE_CONTEXT
                
                .collection
                
                ?.type
                
                ===
                
                13;
                
              if ( ! isStorePage ) return; // bail if not store page
              
              // globals
              
              {
              
                // initialize twc module
                
                window.twc = ( ( self ) => self ) ( window.twc || { } );
                
                // initialize twc ftfml sub-module
                
                twc.ftfml = ( ( self ) => {
                
                  const options = {
                  
                    ids : undefined,
                    
                    response : undefined
                    
                    };
                    
                  Object
                  
                    .assign (
                    
                      self,
                      
                      options
                      
                      );
                      
                  return self;
                  
                  } ) ( twc.ftfml || { } );
                  
                }
                
              const
              
                codeKey = `twc-spftfml`,
                
                detail = ( ) => {
                
                  const
                  
                    callback = ( element ) => {
                    
                      const callback = async ( event ) => {
                      
                        const
                        
                          addOnClassName = 'add-on-card',
                          
                          data = twc.ftfml,
                          
                          element = event
                          
                            .target
                            
                            .closest (
                            
                              [
                              
                                `.${ addOnClassName }`,
                                
                                '.product-detail'
                                
                                ]
                                
                                .join ( ', ' )
                                
                              ),
                              
                          isAddOn = element
                          
                            .classList
                            
                            .contains ( addOnClassName );
                            
                        let
                        
                          context,
                          
                          variants;
                          
                        if ( ! isAddOn ) {
                        
                          context = Static.SQUARESPACE_CONTEXT,
                          
                          variants = context
                          
                            .product
                            
                            .variants;
                            
                          } else {
                          
                            try {
                            
                              const
                              
                                url = element
                                
                                  .querySelector ( '.add-on-title-link' )
                                  
                                  .getAttribute ( 'href' )
                                  
                                  +
                                  
                                  '?format=json',
                                  
                                response = await fetch ( url );
                                
                              if ( ! response.ok ) {
                              
                                const s = `
                                
                                  ${ codeKey } network response was not ok ${
                                  
                                    response
                                    
                                      .statusText
                                      
                                      }
                                      
                                  `
                                  
                                  .trim ( )
                                  
                                  .replace ( /\s+/gm, ' ' );
                                  
                                throw new Error ( s );
                                
                                }
                                
                              context = await response.json ( );
                              
                              variants = context.item.variants;
                              
                              } catch ( error ) {
                              
                                const s = `
                                
                                  ${ codeKey } there has been a problem with your fetch get operation,
                                  
                                  ${ error }.
                                  
                                  `
                                  
                                  .trim ( )
                                  
                                  .replace ( /\s+/gm, ' ' );
                                  
                                console.error ( s );
                                
                                }
                                
                            }
                            
                        data.ids = [ context.itemId ];
                        
                        if ( ! variants ) { // bail if no variants
                        
                          data.response = Promise.resolve ( );
                          
                          return;
                          
                          }
                          
                        let sku;
                        
                        if ( variants.length === 1 )
                        
                          sku = variants [ 0 ].sku;
                          
                          else {
                          
                            const variantsElement = element
                              
                              .querySelector ( '.product-variants' );
                              
                            switch ( true ) {
                            
                              case is71 : {
                              
                                const
                                
                                  elements = variantsElement
                                  
                                    .querySelectorAll (
                                    
                                      '.variant-select-wrapper'
                                      
                                      ),
                                      
                                  isVariantSelected
                                  
                                    =
                                    
                                    !
                                    
                                    [
                                    
                                      ...
                                      
                                      elements
                                      
                                      ]
                                    
                                      .filter (
                                      
                                        e => e
                                        
                                          .getAttribute ( 'data-selected-value' )
                                          
                                          .startsWith ( 'Select ' )
                                          
                                        )
                                        
                                        .length;
                                    
                                // bail if no variant selected
                                
                                if ( ! isVariantSelected ) return;
                                
                                const
                                
                                  attributes = { },
                                  
                                  callback = ( element ) => {
                                  
                                    attributes
                                    
                                      [
                                      
                                        element
                                        
                                          .closest ( '.variant-option' )
                                          
                                          .getAttribute (
                                          
                                            'data-variant-option-name'
                                            
                                            )
                                            
                                        ]
                                        
                                      =
                                      
                                      value = element
                                      
                                        .getAttribute ( 'data-selected-value' );
                                        
                                    };
                                    
                                elements
                                
                                  .forEach ( callback );
                                  
                                sku = variants
                                
                                  .filter (
                                  
                                    v =>
                                    
                                      objectsShallowEqual (
                                      
                                        v.attributes,
                                        
                                        attributes
                                        
                                        )
                                        
                                    )
                                    
                                  [ 0 ]
                                  
                                  .sku;
                                  
                                break;
                                
                                }
                                
                              case is70 : {
                              
                                sku = variantsElement
                                
                                  .getAttribute ( 'data-selected-variant' );
                                  
                                if ( ! sku ) return; // bail if no sku
                                
                                sku = JSON
                                
                                  .parse ( sku )
                                  
                                  .sku;
                                  
                                break;
                                
                                }
                                
                              }
                              
                            }
                            
                        data.ids.push ( sku );
                        
                        data.response = Promise.resolve ( );
                        
                        };
                        
                      element
                      
                        .addEventListener ( 'click', callback );
                        
                      },
                      
                    selector = [
                    
                      // 7.1
                      
                      '.product-detail:not( .product-related-products )'
                      
                        +
                        
                        ':has( :not( .product-mark.sold-out ) ) '
                        
                        +
                        
                        '.sqs-add-to-cart-button-wrapper',
                        
                      // 7.0
                      
                      '.ProductItem:not( .sold-out ) '
                      
                        +
                        
                        '.sqs-add-to-cart-button-wrapper '
                        
                        +
                        
                        '.sqs-add-to-cart-button.use-form'
                        
                      ]
                      
                      .join ( ', ' );
                      
                  document
                  
                    .body
                    
                    .querySelectorAll ( selector )
                    
                    .forEach ( callback );
                    
                  },
                  
                isDetail = ( ( ) => {
                
                  const
                  
                    selector = 'body[ id^="item-" ]',
                    
                    is = document
                    
                      .querySelector ( selector )
                      
                      !==
                      
                      null;
                      
                  return is;
                  
                  } ) ( ),
                  
                isList = ( ( ) => {
                
                  const
                  
                    selector = 'body[ id^="collection-" ]',
                    
                    is = document
                    
                      .querySelector ( selector )
                      
                      !==
                      
                      null;
                      
                  return is;
                  
                  } ) ( ),
                  
                list = ( ) => {
                
                  const callback = ( data ) => {
                    
                    const callback = ( item ) => {
                    
                      const hasForm = item
                      
                        .additionalFieldsFormId;
                        
                      if ( ! hasForm ) return; // bail if no form
                      
                      const variantOptionsLength = item
                      
                        .variantOptionOrdering
                        
                        .length;
                        
                      // bail if more than one option
                      
                      if ( variantOptionsLength > 1 ) return;
                      
                      const
                      
                        selector = '.product-list-item:has( '
                        
                          +
                          
                          `.product-list-item-link[ href="${ item.fullUrl }" ] ) `
                          
                          +
                          
                          '.sqs-add-to-cart-button-wrapper',
                          
                        element = document
                        
                          .body
                          
                          .querySelector ( selector );
                          
                      if ( ! element ) return; // bail if no element
                      
                      element
                      
                        .setAttribute ( 'data-item-id', item.id );
                        
                      const
                      
                        callback = ( event ) => {
                        
                          const
                          
                            data = twc.ftfml,
                            
                            element = event
                            
                              .currentTarget,
                              
                            itemId = element
                            
                              .getAttribute ( 'data-item-id' ),
                              
                            noSku = element
                            
                              .getAttribute ( noSkuAttribute );
                              
                          data.ids = [ itemId ];
                          
                          if ( noSku ) { // bail if no sku
                          
                            data.response = Promise.resolve ( );
                            
                            return;
                            
                            }
                            
                          let sku = element
                          
                            .getAttribute ( `data-${ codeKey }-sku` );
                            
                          if ( sku ) { // bail if sku
                          
                            data.ids.push ( sku );
                            
                            data.response = Promise.resolve ( );
                            
                            return;
                            
                            }
                            
                          const variantsElement = element
                            
                            .closest ( '.product-list-item' )
                            
                            .querySelector ( '.product-variants' );
                            
                          if ( ! variantsElement ) return; // bail if no variants
                          
                          const
                          
                            elements = variantsElement
                            
                              .querySelectorAll (
                              
                                '.variant-select-wrapper'
                                
                                ),
                                
                            isVariantSelected
                            
                              =
                              
                              !
                              
                              [
                              
                                ...
                                
                                elements
                                
                                ]
                              
                                .filter (
                                
                                  e => e
                                  
                                    .getAttribute ( 'data-selected-value' )
                                    
                                    .startsWith ( 'Select ' )
                                    
                                  )
                                  
                                  .length;
                                  
                          // bail if no variant selected
                          
                          if ( ! isVariantSelected ) return;
                          
                          const
                          
                            attributes = { },
                            
                            callback = ( element ) => {
                            
                              attributes
                              
                                [
                                
                                  element
                                  
                                    .closest ( '.variant-option' )
                                    
                                    .getAttribute (
                                    
                                      'data-variant-option-name'
                                      
                                      )
                                      
                                  ]
                                  
                                =
                                
                                value = element
                                
                                  .getAttribute ( 'data-selected-value' );
                                  
                              };
                              
                          elements
                          
                            .forEach ( callback );
                            
                          sku = variants
                          
                            .filter (
                            
                              v =>
                              
                                objectsShallowEqual (
                                
                                  v.attributes,
                                  
                                  attributes
                                  
                                  )
                                  
                              )
                              
                            [ 0 ]
                            
                            .sku;
                            
                          data.ids.push ( sku );
                          
                          data.response = Promise.resolve ( );
                          
                          },
                          
                        noSkuAttribute = `data-${ codeKey }-no-sku`,
                        
                        variants = item.variants,
                        
                        variantsLength = variants.length;
                        
                      if ( ! variantsLength )
                      
                        element
                        
                          .setAttribute ( noSkuAttribute, '' );
                          
                        else if ( variantsLength === 1 ) {
                        
                          const
                          
                            variant = variants [ 0 ],
                            
                            isNoStock =
                            
                              !
                              
                              variant.unlimited
                              
                              &&
                              
                              !
                              
                              variant.qtyInStock;
                              
                          if ( isNoStock ) return; // bail no stock
                          
                          element
                          
                            .setAttribute (
                            
                              `data-${ codeKey }-sku`,
                              
                              variant.sku
                              
                              );
                              
                          }
                          
                      element
                      
                        .addEventListener ( 'click', callback );
                        
                      };
                      
                    data
                    
                      .items
                      
                      .forEach ( callback );
                      
                    };
                    
                  const url = location
                  
                    .pathname
                    
                    +
                    
                    '?format=json';
                    
                  fetch ( url )
                  
                    .then ( response => response.json ( ) )
                    
                    .then ( callback );
                      
                  },
                  
                objectsShallowEqual = ( obj1, obj2 ) => {
                
                  const
                  
                    keys1 = Object.keys ( obj1 ),
                    
                    keys2 = Object.keys ( obj2 );
                    
                  let isEqual = keys1.length === keys2.length;
                  
                  // bail id keys lengths not equal
                  
                  if ( ! isEqual ) return false;
                  
                  for ( let key of keys1 ) {
                  
                    isEqual = obj1 [ key ] === obj2 [ key ];
                    
                    // bail if key/value pair not equal
                    
                    if ( ! isEqual ) return false;
                    
                    }
                    
                  return true;
                  
                  },
                  
                ssVersion = Static
                
                  .SQUARESPACE_CONTEXT
                  
                  .templateVersion,
                  
                is70 = ssVersion === '7',
                
                is71 = ssVersion === '7.1';
                
              switch ( true ) {
              
                case isDetail:
                
                  detail ( );
                  
                  break;
                  
                case isList:
                
                  if ( ! is71 ) return; // bail if not 7.1
                  
                  list ( );
                  
                  break;
                  
                }
                
              };
              
            document.addEventListener ( 'DOMContentLoaded', callback );
            
            } ) ( );
            
          </script>
          
      <!-- end TWC Store Page Form Text Field Max Length -->
    
    <!-- begin TWC Product Custom Form Text Field Max Length -->
    
      <!--
      
        product custom form text field max length
        
        License         : < https://tinyurl.com/s872fb68 >
        
        Version         : 0.1.1
        
        SS Versions     : 7.1, 7.0
        
        v7.1
        Fluid
        Engine
        Compatible      : Not Applicable
        
        v7.0 Templates  : Brine ( Aria, Blend, Burke, Cacao, Clay, Fairfield, Feed,
                          Foster, Greenwich, Hatch, Heights, Hunter, Hyde, Impact,
                          Jaunt, Juke, Keene, Kin, Lincoln, Maple, Margot, Marta,
                          Mentor, Mercer, Miller, Mojave, Moksha, Motto, Nueva,
                          Pedro, Pursuit, Rally, Rover, Royce, Sofia, Sonora,
                          Stella, Thorne, Vow, Wav, West )
                          
                          your template is not listed? then it is not currently
                          supported
        
        Dependencies    : modal lightbox observe changes
                          
                          product quick view form text field max length
        
        Notes           : this code does not work on the checkout page. it is a
                          Squarespace security feature that no code can alter the
                          checkout page
                          
                          this code is client side and making use of an HTML form
                          feature. Since this code is client side it is possible to
                          bypass the max length limit this code is setting. in other
                          words you still need to be checking manually when forms or
                          orders come in to make sure your limits are not being
                          exceeded. consider this code more of an aid to help users
                          not exceed your field max length limits
        
        Copyright       : 2024-2025 Thomas Creedon
                          
                          Tom's Web Consulting < http://www.tomsWeb.consulting/ >
        
        no user serviceable parts below
        
        -->
        
      <style>
      
        .sqs-async-form-content .form-wrapper .field-list .field .field-element[ placeholder*="ftfml" ] {
        
          visibility : hidden;
          
          }
          
        </style>
        
      <script>
      
        ( ( ) => {
        
          const
          
            version = '0.1.1',
            
            s = `Product Custom Form Text Field Max Length v${ version }
            
              License < https://tinyurl.com/s872fb68 >
              
              Â© 2024-2025 Thomas Creedon
              
              Tom's Web Consulting < http://www.tomsWeb.consulting >`
              
              .replace ( /^\s+/gm, '' );
              
          console.log ( s );
          
          // globals
          
          {
          
            // initialize twc module
            
            window.twc = ( ( self ) => self ) ( window.twc || { } );
            
            // initialize twc ftfml sub-module
            
            twc.ftfml = ( ( self ) => {
            
              const options = {
              
                ids : undefined,
                
                response : undefined
                
                };
                
              Object
              
                .assign (
                
                  self,
                  
                  options
                  
                  );
                  
              return self;
              
              } ) ( twc.ftfml || { } );
              
            }
            
          } ) ( );
          
        var twcPcftfml = ( node ) => {
        
          const
          
            codeKey = `twc-pcftfml`,
            
            selector = '.form-wrapper input[ placeholder*="ftfml" ]',
            
            elements = node
            
              .querySelectorAll ( selector );
              
          if ( ! elements.length ) return; // bail if no elements
          
          const callback = ( ) => {
          
            const callback = ( element ) => {
            
              const
              
                attribute = 'placeholder',
                
                re = /^ftfml\s*:\s*{([^}]+)}\s*/;
              
              let
              
                text = element
                
                  .getAttribute ( attribute ),
                  
                m = text.match ( re );
                
              // clean up placeholder attribute value
              
              {
              
                text = text
                
                  .replace ( m [ 0 ], '' )
                  
                  .trim ( );
                  
                if ( text ) // set/show placeholder or remove
                
                  element
                  
                    .setAttribute ( attribute, text );
                    
                  else
                  
                    element.removeAttribute ( attribute );
                    
                }
                
              let maxLength = m [ 1 ].trim ( );
              
              if ( isNaN ( maxLength ) ) {
              
                const callback = ( key ) => {
                
                  const b = ! twc
                  
                    .ftfml
                    
                    .ids
                    
                    .includes ( key );
                    
                  if ( b ) return; // bail if no key
                  
                  maxLength = idMaxlengthMap [ key ];
                  
                  };
                  
                const
                
                  json = '{' +
                  
                    maxLength
                    
                      .replace ( /[\s]/g, '' )
                      
                      .split ( ',' )
                      
                      .map ( s => s.replace ( /([^:]+)/, '"$1"' ) )
                      
                      .join ( ',' ) +
                      
                    '}',
                    
                  key = 'default',
                  
                  idMaxlengthMap = JSON.parse ( json );
                  
                maxLength = '';
                
                if ( key in idMaxlengthMap )
                
                  maxLength = idMaxlengthMap [ key ];
                  
                Object
                
                  .keys ( idMaxlengthMap )
                  
                  .forEach ( callback );
                  
                }
                
              if ( maxLength )
              
                element
                
                  .setAttribute ( 'maxlength', maxLength );
                  
              };
              
            elements.forEach ( callback );
            
            };
            
          twc
          
            .ftfml
            
            .response
            
            .finally ( callback );
            
          };
          
        </script>
        
      <!-- end TWC Product Custom Form Text Field Max Length -->
    
    <!-- begin TWC Product Quick View Form Text Field Max Length -->
    
      <!--
      
        product quick view form text field max length
        
        License         : < https://tinyurl.com/s872fb68 >
        
        Version         : 0.1.1
        
        SS Versions     : 7.1, 7.0
        
        v7.1
        Fluid
        Engine
        Compatible      : Not Applicable
        
        v7.0 Templates  : Brine ( Aria, Blend, Burke, Cacao, Clay, Fairfield, Feed,
                          Foster, Greenwich, Hatch, Heights, Hunter, Hyde, Impact,
                          Jaunt, Juke, Keene, Kin, Lincoln, Maple, Margot, Marta,
                          Mentor, Mercer, Miller, Mojave, Moksha, Motto, Nueva,
                          Pedro, Pursuit, Rally, Rover, Royce, Sofia, Sonora,
                          Stella, Thorne, Vow, Wav, West )
                          
                          your template is not listed? then it is not currently
                          supported
        
        Dependencies    : product quick view observe changes
        
        Notes           : this code does not work on the checkout page. it is a
                          Squarespace security feature that no code can alter the
                          checkout page
                          
                          this code is client side and making use of an HTML form
                          feature. Since this code is client side it is possible to
                          bypass the max length limit this code is setting. in other
                          words you still need to be checking manually when forms or
                          orders come in to make sure your limits are not being
                          exceeded. consider this code more of an aid to help users
                          not exceed your field max length limits
        
        Copyright       : 2024-2025 Thomas Creedon
                          
                          Tom's Web Consulting < http://www.tomsWeb.consulting/ >
        
        no user serviceable parts below
        
        -->
        
      <script>
      
        ( ( ) => {
        
          const
          
            title = 'Product Quick View Form Text Field Max Length',
            
            version = '0.1.1',
            
            s = `${ title } v${ version }
            
              License < https://tinyurl.com/s872fb68 >
              
              Â© 2024-2025 Thomas Creedon
              
              Tom's Web Consulting < http://www.tomsWeb.consulting >`
              
              .replace ( /^\s+/gm, '' );
              
          console.log ( s );
          
          // globals
          
          {
          
            // initialize twc module
            
            window.twc = ( ( self ) => self ) ( window.twc || { } );
            
            // initialize twc ftfml sub-module
            
            twc.ftfml = ( ( self ) => {
            
              const options = {
              
                ids : undefined,
                
                response : undefined
                
                };
                
              Object
              
                .assign (
                
                  self,
                  
                  options
                  
                  );
                  
              return self;
              
              } ) ( twc.ftfml || { } );
              
            }
            
          } ) ( );
          
        var twcPqvftfml = ( element ) => {
        
          const
          
            handleEvent = ( event ) => {
            
              const
              
                data = twc.ftfml,
                
                element = event
                
                  .currentTarget,
                  
                metaElement = element
                
                  .closest (
                  
                    [
                    
                      '.product-meta', // 7.1
                      
                      '.ProductItem-details' // 7.0
                      
                      ]
                      
                      .join ( ', ' )
                      
                    ),
                    
                setAttributes = ( ) => {
                
                  const callback = ( element ) => {
                  
                    attributes
                    
                      [
                      
                        element
                        
                          .getAttribute ( 'data-variant-option-name' )
                          
                        ]
                        
                      =
                      
                      element
                      
                        .querySelector ( 'select' )
                        
                        .value;
                        
                    };
                    
                  variantElements
                  
                    .forEach ( callback );
                    
                  },
                  
                setVariantSku = ( ) => {
                
                  sku = variants [
                  
                    JSON
                    
                      .stringify (
                      
                        attributes
                        
                        )
                        
                    ];
                    
                  },
                  
                variantElements
                
                  =
                  
                  metaElement
                  
                    .querySelectorAll ( '.product-variants .variant-option' ),
                    
                isVariantSelected
                
                  =
                  
                  variantElements
                  
                    .length
                    
                  &&
                  
                  !
                  
                  [
                  
                    ...
                    
                    variantElements
                    
                    ]
                  
                    .filter ( e => ! e.querySelector ( 'select' )?.value )
                    
                    .length;
                    
              let
              
                attributes = { },
                
                itemId,
                
                sku,
                
                variants;
                
              data.ids = [ ];
              
              if ( element.twcPqvftfml ) {
              
                const p = element.twcPqvftfml;
                
                itemId = p.itemId;
                
                variants = p.variants;
                
                const l = variants
                
                  &&
                  
                  Object
                  
                    .keys ( variants )
                    
                    .length;
                    
                switch ( true ) {
                
                  case ! variants :
                  
                    break;
                    
                  case l === 1 :
                  
                    sku = variants [ '{}' ];
                    
                    break;
                    
                  case l > 1 : {
                  
                    if ( isVariantSelected ) {
                    
                      setAttributes ( );
                      
                      setVariantSku ( );
                      
                      }
                      
                    break;
                    
                    }
                    
                  }
                  
                data.ids.push (
                
                  ...
                  
                  [ p.itemId, sku ]
                  
                    .filter ( e => e )
                    
                  );
                  
                data.response = Promise.resolve ( );
                
                } else {
                
                  const url = metaElement
                  
                    .querySelector (
                    
                      [
                      
                        '.quick-view-item-link', // 7.1
                        
                        '.ProductItem-details-quickViewFullItemLink' // 7.0
                        
                        ]
                        
                        .join ( ', ' )
                        
                      )
                      
                    .getAttribute ( 'href' )
                    
                    +
                    
                    '?format=json';
                    
                  data.response = fetch ( url )
                  
                    .then ( ( response ) => {
                    
                      if ( ! response.ok ) {
                      
                        const s = `
                        
                          ${ codeKey } network response was not ok ${
                          
                            response
                            
                              .statusText
                              
                              }
                              
                          `
                          
                          .trim ( )
                          
                          .replace ( /\s+/gm, ' ' );
                          
                        throw new Error ( s );
                        
                        }
                        
                      const obj = response.json ( );
                      
                      return obj;
                      
                      } )
                      
                    .then ( ( obj ) => {
                    
                      const
                      
                        item = obj.item,
                        
                        l = item.variants.length;
                        
                      itemId = item.id;
                      
                      if ( l ) {
                      
                        const callback = ( variant ) => {
                        
                          const optionOrdering
                          
                            =
                            
                            item
                            
                              .variantOptionOrdering;
                              
                          let obj = { };
                          
                          if ( optionOrdering.length )
                          
                            obj = optionOrdering
                            
                              .reduce ( ( acc, key ) => {
                              
                                if ( key in variant.attributes )
                                
                                  acc [ key ] = variant.attributes [ key ];
                                  
                                return acc;
                                
                                }, { } );
                                
                          variants [
                          
                            JSON.stringify ( obj )
                            
                            ]
                            
                            =
                            
                            variant
                            
                              .sku;
                              
                          };
                          
                        variants = { };
                        
                        item
                        
                          .variants
                          
                          .forEach ( callback );
                          
                        }
                        
                      switch ( true ) {
                      
                        case ! variants :
                        
                          break;
                          
                        case l === 1 :
                        
                          sku = variants [ '{}' ];
                          
                          break;
                          
                        case l > 1 : {
                        
                          if ( isVariantSelected ) {
                          
                            setAttributes ( );
                            
                            setVariantSku ( );
                            
                            }
                            
                          break;
                          
                          }
                          
                        }
                        
                      data.ids.push (
                      
                        ...
                        
                        [ itemId, sku ]
                        
                          .filter ( e => e )
                          
                        );
                        
                      element.twcPqvftfml = {
                      
                        itemId : itemId,
                        
                        variants : variants
                        
                        };
                        
                      } );
                      
                  }
                  
              },
              
            codeKey = `twc-pqvftfml`,
            
            selector = [
            
              // 7.1
              
              '.product-detail:not( :has( .product-mark.sold-out ) ) '
              
                +
                
                '.sqs-add-to-cart-button-wrapper',
                
              // 7.0
              
              '.ProductItem:not( .sold-out ) .sqs-add-to-cart-button-wrapper '
              
                +
                
                '.sqs-add-to-cart-button.use-form'
                
              ]
              
              .join ( ', ' );
              
          element = element
            
            .querySelector ( selector );
            
          if ( ! element ) return; // bail if no element
          
          element
          
            .addEventListener ( 'click', handleEvent );
            
          };
          
        </script>
        
      <!-- end TWC Product Quick View Form Text Field Max Length -->
    
    <!-- begin TWC Product Quick View Observe Changes Options -->
    
      <!--
      
        product quick view observe changes options
        
        License      : < https://tinyurl.com/s872fb68 >
        
        Version      : 0.2.0
        
        SS Versions  : 7.1, 7.0
        
        Copyright    : 2024-2025 Thomas Creedon
                       
                       Tom's Web Consulting < http://www.tomsWeb.consulting/ >
        
        -->
        
      <script>
      
        // initialize twc module
        
        window.twc = ( ( self ) => self ) ( window.twc || { } );
        
        // initialize twc pqvoc sub-module
        
        twc.pqvoc = ( ( self ) => self ) ( twc.pqvoc || { } );
        
        // initialize twc pqvoc callbacks sub-module
        
        twc.pqvoc.callbacks = ( ( self ) => {
        
          const callbacks = [
            
            /*
            
              following is an example line. copy and paste it after the example
              line. remove the double forward slash space of the new line. enter the
              name of your callback
              
              */
              
            // '[ enter your callback name here between single quotes replacing square brackets ]',
            
            'twcPqvftfml',
            
            ];
            
          self.push ( ... callbacks );
          
          return self;
          
          } ) ( twc.pqvoc.callbacks || [ ] );
          
        </script>
        
      <!-- end TWC Product Quick View Observe Changes Options -->
    
    <!-- begin TWC Product Quick View Observe Changes -->
    
      <!--
      
        product quick view observe changes
        
        License       : < https://tinyurl.com/s872fb68 >
        
        Version       : 0.2.0
        
        SS Versions   : 7.1, 7.0
        
        v7.1
        Products V2
        Compatible    : Yes
        
        v7.1
        Fluid
        Engine
        Compatible    : Not Applicable
        
        Dependencies  : modal lightbox observe changes
                        
                        < https://tinyurl.com/2pfvaeud >
        
        Note          : this code is a base for other effects. on its own it doesn't
                        do anything. this code is not the end all be all of mutation
                        observers. it may not cover your needs
        
        Copyright     : 2024-2025 Thomas Creedon
                        
                        Tom's Web Consulting < http://www.tomsWeb.consulting/ >
        
        no user serviceable parts below
        
        -->
        
      <script>
      
        ( ( ) => {
        
          const
          
            version = '0.2.0',
            
            s = `Product Quick View Observe Changes v${ version }
            
              License < https://tinyurl.com/s872fb68 >
              
              Â© 2024-2025 Thomas Creedon
              
              Tom's Web Consulting < http://www.tomsWeb.consulting >`
              
              .replace ( /^\s+/gm, '' );
              
          console.log ( s );
          
          // globals
          
          {
          
            // initialize twc module
            
            window.twc = ( ( self ) => self ) ( window.twc || { } );
            
            // initialize twc pqvoc sub-module
            
            twc.pqvoc = ( ( self ) => self ) ( twc.pqvoc || { } );
            
            // initialize twc pqvoc callbacks sub-module
            
            twc.pqvoc.callbacks =
            
              ( ( self ) => self ) ( twc.pqvoc.callbacks || [ ] );
              
            }
            
          } ) ( );
          
        var twcPqvoc = ( node ) => {
        
          const isQuickView = node
          
            .classList
            
            .contains ( 'sqs-product-quick-view-lightbox' );
            
          if ( ! isQuickView ) return; // bail if no product quick view
          
          const
          
            callback = ( mutations ) => {
            
              const callback = ( mutation ) => {
              
                let hasAdded = mutation.addedNodes.length;
                
                if ( ! hasAdded ) return; // continue
                
                const
                
                  element = mutation
                  
                    .addedNodes
                    
                    [ 0 ],
                    
                  isProduct = [
                  
                    'product-detail', // 7.1
                    
                    'ProductItem' // 7.0
                    
                    ]
                    
                    .some ( c => element.classList.contains ( c ) );
                    
                if ( ! isProduct ) return; // bail if not product item
                
                const callback = ( callback ) => {
                
                  try {
                  
                    callback = window [ callback ];
                    
                    callback ( element );
                    
                    } catch ( error ) {
                    
                      const s = `${ codeKey } callback error`;
                      
                      console.error ( s, error );
                      
                      }
                      
                  };
                  
                options
                
                  .callbacks
                  
                  .forEach ( callback );
                  
                };
                
              mutations.forEach ( callback );
              
              },
              
            codeKey = 'twc-pqvoc',
            
            config = {
            
              childList : true
              
              },
              
            observer = new MutationObserver ( callback ),
            
            options = codeKey
            
              .split ( '-' )
              
              .reduce ( ( obj, key ) => obj?.[ key ], window ),
              
            selector = '.sqs-product-quick-view-content',
            
            element = node
            
              .querySelector ( selector );
              
          // start listening for changes in element
          
          observer.observe ( element, config );
          
          };
          
        </script>
        
      <!-- end TWC Product Quick View Observe Changes -->
    
    <!--
    
      begin modal lightbox observe changes
      
      License       : < https://tinyurl.com/s872fb68 >
      
      Version       : 0.1.1
      
      SS Versions   : 7.1, 7.0
      
      v7.1
      Fluid
      Engine
      Compatible    : Not Applicable
      
      Note          : this code is a base for other effects. on its own it
                      doesn't do anything. this code is not the end all be all
                      of mutation observers. it may not cover your needs
      
      By            : Thomas Creedon < http://www.tomsWeb.consulting/ >
      
      -->
      
      <script>
        
        if ( window.twc == undefined ) window.twc = { };
        
        twc.mloc = {
        
          callbacks : [
          
            /*
            
              following is an example line. copy and paste it after the example
              line. remove the double forward slash space of the new line. replace
              the name with your callback
              
              */
              
            // '[ enter your callback name here replacing square brackets ]',
            
            'twcPqvoc',
            
            'twcPcftfml',
            
            ]
            
          };
          
        </script>
        
      <!-- do not change anything below, there be the borg here -->
      
      <script>
      
        document.addEventListener ( 'DOMContentLoaded', ( ) => {
        
          const version = '0.1.1';
          
          const s = `Modal Lightbox Observe Changes v${ version }, ` +
          
            'License < https://tinyurl.com/s872fb68 >, ' +
            
            'Tom\'s Web Consulting < http://www.tomsWeb.consulting >';
            
          console.log ( s );
          
          const callback = ( mutations ) => {
          
            const callback = ( mutation ) => {
            
              const callback = ( node ) => {
              
                const b = ! node
                
                  .classList
                  
                  .contains ( 'sqs-modal-lightbox' );
                  
                if ( b ) return; // bail if not element of interest
                
                const callback = ( callback ) => {
                
                  try {
                  
                    callback = window [ callback ];
                    
                    callback ( node );
                    
                    } catch ( error ) {
                    
                      const s = `${ codeKey } callback error`;
                      
                      console.error ( s, error );
                      
                      }
                      
                  };
                  
                twc
                
                  [ codeKeySuffix ]
                  
                  .callbacks
                  
                  .forEach ( callback );
                  
                };
                
              mutation
              
                .addedNodes
                
                .forEach ( callback );
                
              };
              
            mutations.forEach ( callback );
            
            };
            
          const codeKeySuffix = 'mloc';
          
          const codeKey = `twc-${ codeKeySuffix }`;
          
          const config = {
          
            childList : true
            
            };
            
          const observer = new MutationObserver ( callback );
          
          // start listening for changes in body
          
          observer.observe ( document.body, config );
          
          } );
          
        </script>
        
      <!-- end modal lightbox observe changes -->
    
    <!-- begin TWC Cart Page Form Text Field Max Length -->
    
      <!--
      
        cart page form text field max length
        
        License       : < https://tinyurl.com/s872fb68 >
        
        Version       : 0.1.2
        
        SS Versions   : 7.1, 7.0
        
        v7.1
        Fluid
        Engine
        Compatible    : Not Applicable
        
        Dependencies  : cart page observe changes
        
        Notes         : this code does not work on the checkout page. it is a
                        Squarespace security feature that no code can alter the
                        checkout page
    
                        this code is client side and making use of an HTML form
                        feature. Since this code is client side it is possible to
                        bypass the max length limit this code is setting. in other
                        words you still need to be checking manually when forms or
                        orders come in to make sure your limits are not being
                        exceeded. consider this code more of an aid to help users
                        not exceed your field max length limits
        
        Copyright     : 2024-2025 Thomas Creedon
                        
                        Tom's Web Consulting < http://www.tomsWeb.consulting/ >
        
        no user serviceable parts below
        
        -->
        
      <style>
      
        html:not( .squarespace-damask ) #sqs-cart-container .cart-product-form-wrapper input[ placeholder*="ftfml" ] {
        
          visibility : hidden;
          
          }
          
        </style>
        
      <script>
      
        ( ( ) => {
        
          const
          
            version = '0.1.2',
            
            s = `Cart Page Form Text Field Max Length v${ version }
            
              License < https://tinyurl.com/s872fb68 >
              
              Â© 2024-2025 Thomas Creedon
              
              Tom's Web Consulting < http://www.tomsWeb.consulting >`
              
              .replace ( /^\s+/gm, '' );
              
          console.log ( s );
          
          // globals
          
          {
          
            // initialize twc module
            
            window.twc = ( ( self ) => self ) ( window.twc || { } );
            
            // initialize twc cpftfml sub-module
            
            twc.cpftfml = ( ( self ) => {
            
              const options = {
              
                ids : undefined
                
                };
                
              Object
              
                .assign (
                
                  self,
                  
                  options
                  
                  );
                  
              return self;
              
              } ) ( twc.cpftfml || { } );
              
            }
            
          } ) ( );
          
        var twcCpftfml = ( node ) => {
        
          const hasQuerySelector
          
            =
            
            node
            
              .querySelector;
              
          if ( ! hasQuerySelector ) return; // bail if no querySelector
          
          let selector;
          
          // cart container
          
          ( ( ) => {
          
            const isCartContainerElement
            
              =
              
              node
              
                .classList
                
                .contains ( 'cart-container' );
                
            // bail if not cart container element
            
            if ( ! isCartContainerElement ) return;
            
            selector = '.cart-row';
            
            const
            
              callback = ( element ) => {
              
                const callback = ( event ) => {
                
                  console.log ( event );
                  
                  const
                  
                    callback = ( item ) => {
                    
                      console.log ( item );
                      
                      const b = ! ( 'productForm' in item );
                      
                      if ( b ) return [ ]; // bail if no product form
                      
                      const ids = [ item.productId ];
                      
                      if ( item.sku !== undefined )
                      
                        ids.push ( item.sku );
                        
                      return ids;
                      
                      },
                      
                    i = [
                    
                      ...
                      
                      cartRowElements
                      
                      ]
                      
                      .indexOf (
                      
                        element
                        
                          .closest ( '.cart-row' )
                          
                        ),
                        
                    selector =
                    
                      '#sqs-cart-root script[ type="application/json" ]';
                      
                  twc.cpftfml.ids = JSON
                  
                    .parse (
                    
                      document
                      
                        .body
                        
                        .querySelector ( selector )
                        
                        .textContent
                        
                      )
                      
                    .cart
                    
                    .items
                    
                    .map ( callback )
                    
                    [ i ];
                    
                  };
                  
                element.addEventListener ( 'click', callback );
                
                },
                
              cartRowElements = node
              
                .querySelectorAll ( selector );
                
            selector = '.cart-row-edit';
            
            node
            
              .querySelectorAll ( selector )
              
              .forEach ( callback );
              
            } ) ( );
            
          // cart product form container
          
          ( ( ) => {
          
            selector = '.cart-product-form-container';
            
            let elements = node
            
              .querySelector ( selector );
              
            if ( ! elements ) return; // bail if no element
            
            const callback = ( element ) => {
            
              const
              
                attribute = 'placeholder',
                
                re = /^ftfml\s*:\s*{([^}]+)}\s*/;
                
              let
              
                text = element
                
                  .getAttribute ( attribute ),
                  
                m = text.match ( re );
                
              // clean up placeholder attribute value
              
              {
              
                text = text
                
                  .replace ( m [ 0 ], '' )
                  
                  .trim ( );
                  
                if ( text ) // set/show placeholder or remove
                
                  element
                  
                    .setAttribute ( attribute, text );
                    
                  else
                  
                    element.removeAttribute ( attribute );
                    
                }
                
              let maxLength = m [ 1 ]
              
                .trim ( );
                
              if ( isNaN ( maxLength ) ) {
              
                const callback = ( key ) => {
                
                  const b = ! twc
                  
                    .cpftfml
                    
                    .ids
                    
                    .includes ( key );
                    
                  if ( b ) return; // bail if no key
                  
                  maxLength = idMaxlengthMap [ key ];
                  
                  };
                  
                const
                
                  json = '{' +
                  
                    maxLength
                    
                      .replace ( /[\s]/g, '' )
                      
                      .split ( ',' )
                      
                      .map ( s => s.replace ( /([^:]+)/, '"$1"' ) )
                      
                      .join ( ',' ) +
                      
                    '}',
                    
                  key = 'default',
                  
                  idMaxlengthMap = JSON.parse ( json );
                  
                maxLength = '';
                
                if ( key in idMaxlengthMap )
                
                  maxLength = idMaxlengthMap [ key ];
                  
                Object
                
                  .keys ( idMaxlengthMap )
                  
                  .forEach ( callback );
                  
                }
                
              if ( maxLength )
              
                element
                
                  .setAttribute ( 'maxlength', maxLength );
                  
              };
              
            selector = '.cart-product-form-field-label ' +
            
              'input[ placeholder*="ftfml" ]';
              
            elements = elements
            
              .querySelectorAll ( selector )
              
              .forEach ( callback );
              
            } ) ( );
            
          };
          
        </script>
        
      <!-- end TWC Cart Page Form Text Field Max Length -->
    
    <script>
    
      document.addEventListener ( 'DOMContentLoaded', ( ) => {
      
        /*
        
          cart page observe changes
          
          License       : < https://tinyurl.com/s872fb68 >
          
          Version       : 0.2.2
          
          SS Versions   : 7.1, 7.0
          
          v7.1
          Fluid
          Engine
          Compatible    : Not Applicable
          
          Note          : this code is a base for other effects. on its own it
                          doesn't do anything. this code is not the end all be all
                          of mutation observers. it may not cover your needs
          
          By            : Thomas Creedon < http://www.tomsWeb.consulting/ >
          
          */
          
        const callbacks = {
        
          added : [
          
            /*
            
              following is an example line. copy and paste it after the example
              line. remove the double forward slash space of the new line. replace
              the name with your callback
              
              */
              
            // '[ optional, enter your callback name here replacing square brackets ]',
            
            'twcCpftfml',
            
            ],
            
          removed : [
          
            /*
            
              following is an example line. copy and paste it after the example
              line. remove the double forward slash space of the new line. replace
              the name with your callback
              
              */
              
            // '[ optional, enter your callback name here replacing square brackets ]',
            
            ]
            
          };
          
        // do not change anything below, there be the borg here
        
        const version = '0.2.2';
        
        const s = `Cart Page Observe Changes v${ version }, ` +
        
          'License < https://tinyurl.com/s872fb68 >, ' +
          
          'Tom\'s Web Consulting < http://www.tomsWeb.consulting >';
          
        console.log ( s );
        
        let b = location.pathname != '/cart';
        
        if ( b ) return; // bail if not cart page
        
        b = ! ( 'MutationObserver' in window );
        
        if ( b ) return; // bail if no mutation observer available
        
        const callback = ( mutations ) => {
        
          const callback = ( mutation ) => {
          
            const callback = ( node ) => {
            
              const callback = ( callback ) => {
              
                const cllbck = window [ callback ];
                
                try {
                
                  cllbck ( node );
                  
                  } catch ( error ) {
                  
                    const s = `${ codeKey } : ${ callback } `;
                    
                    console.error ( s, error );
                    
                    }
                    
                };
                
              cllbcks.forEach ( callback );
                
              };
              
            const nodesAdded = mutation.addedNodes;
            
            const nodesRemoved = mutation.removedNodes;
            
            let cllbcks;
            
            let nodes;
            
            switch ( true ) {
            
              case Boolean ( nodesAdded.length ):
              
                cllbcks = callbacks.added;
                
                nodes = nodesAdded
                
                break;
                
              case Boolean ( nodesRemoved.length ) :
              
                cllbcks = callbacks.removed;
                
                nodes = nodesRemoved;
                
                break;
                
              }
              
            nodes.forEach ( callback );
            
            };
            
          mutations.forEach ( callback );
          
          };
          
        const codeKey = 'twc-cpoc';
        
        const observer = new MutationObserver ( callback );
          
        const element = document
        
          .getElementById ( 'sqs-cart-container' );
          
        const options = {
        
          childList : true,
          
          subtree : true
          
          };
          
        // begin listening for changes in element
        
        observer.observe ( element, options );
          
        } );
        
      </script>
      
    <!-- end TWC Product Custom Form Text Field Max Length -->
  <!-- begin TWC Product Block Form Text Field Max Length -->
  
    <!--
    
      product block form text field max length
      
      License         : < https://tinyurl.com/s872fb68 >
      
      Version         : 0.1.1
      
      SS Versions     : 7.1, 7.0
      
      v7.1
      Fluid
      Engine
      Compatible      : Yes
      
      v7.0 Templates  : Brine ( Aria, Blend, Burke, Cacao, Clay, Fairfield, Feed,
                        Foster, Greenwich, Hatch, Heights, Hunter, Hyde, Impact,
                        Jaunt, Juke, Keene, Kin, Lincoln, Maple, Margot, Marta,
                        Mentor, Mercer, Miller, Mojave, Moksha, Motto, Nueva,
                        Pedro, Pursuit, Rally, Rover, Royce, Sofia, Sonora,
                        Stella, Thorne, Vow, Wav, West )
                        
                        your template is not listed? then it is not currently
                        supported
      
      Dependencies    : product quick view form text field max length
                        
                        product custom form text field max length
      
      Notes           : this code does not work on the checkout page. it is a
                        Squarespace security feature that no code can alter the
                        checkout page
                        
                        this code is client side and making use of an HTML form
                        feature. Since this code is client side it is possible to
                        bypass the max length limit this code is setting. in other
                        words you still need to be checking manually when forms or
                        orders come in to make sure your limits are not being
                        exceeded. consider this code more of an aid to help users
                        not exceed your field max length limits
      
      Copyright       : 2024-2025 Thomas Creedon
                        
                        Tom's Web Consulting < http://www.tomsWeb.consulting/ >
      
      no user serviceable parts below
      
      -->
      
    <style>
    
      .collection-type-page .sqs-async-form-content .form-wrapper .field-list .field .field-element[ placeholder*="ftfml" ] {
      
        visibility : hidden;
        
        }
        
      </style>
      
    <script>
    
      ( ( ) => {
      
        const
        
          version = '0.1.1',
          
          s = `Product Block Form Text Field Max Length v${ version }
          
            License < https://tinyurl.com/s872fb68 >
            
            Â© 2024-2025 Thomas Creedon
            
            Tom's Web Consulting < http://www.tomsWeb.consulting >`
            
            .replace ( /^\s+/gm, '' );
            
        console.log ( s );
        
        const callback = ( ) => {
        
          // globals
          
          {
          
            // initialize twc module
            
            window.twc = ( ( self ) => self ) ( window.twc || { } );
            
            // initialize twc ftfml sub-module
            
            twc.ftfml = ( ( self ) => {
            
              const options = {
              
                ids : undefined,
                
                response : undefined
                
                };
                
              Object
              
                .assign (
                
                  self,
                  
                  options
                  
                  );
                  
              return self;
              
              } ) ( twc.ftfml || { } );
              
            }
            
          const
          
            codeKey = 'twc-pbftfml',
            
            handleEvent = ( event ) => {
            
              const
              
                data = twc.ftfml,
                
                element = event
                
                  .currentTarget,
                  
                detailsElement = element
                
                  .closest ( '.productDetails' ),
                  
                setAttributes = ( ) => {
                
                  const callback = ( element ) => {
                  
                    attributes
                    
                      [
                      
                        element
                        
                          .getAttribute ( 'name' )
                          
                        ]
                        
                      =
                      
                      element
                      
                        .value;
                        
                    };
                    
                  variantElements
                  
                    .forEach ( callback );
                    
                  },
                  
                setVariantSku = ( ) => {
                
                  sku = variants [
                  
                    JSON
                    
                      .stringify (
                      
                        attributes
                        
                        )
                        
                    ];
                    
                  },
                  
                variantElements
                
                  =
                  
                  detailsElement
                  
                    .querySelectorAll ( '.product-variants select' ),
                    
                isVariantSelected
                
                  =
                  
                  variantElements
                  
                    .length
                    
                  &&
                  
                  !
                  
                  [
                  
                    ...
                    
                    variantElements
                    
                    ]
                  
                    .filter ( e => ! e.value )
                    
                    .length;
                    
              let
              
                attributes = { },
                
                itemId,
                
                sku,
                
                variants;
                
              data.ids = [ ];
              
              if ( element.twcPbftfml ) {
              
                const p = element.twcPbftfml;
                
                itemId = p.itemId;
                
                variants = p.variants;
                
                const l = variants
                
                  &&
                  
                  Object
                  
                    .keys ( variants )
                    
                    .length;
                    
                switch ( true ) {
                
                  case ! variants :
                  
                    break;
                    
                  case l === 1 :
                  
                    sku = variants [ '{}' ];
                    
                    break;
                    
                  case l > 1 : {
                  
                    if ( isVariantSelected ) {
                    
                      setAttributes ( );
                      
                      setVariantSku ( );
                      
                      }
                      
                    break;
                    
                    }
                    
                  }
                  
                data.ids.push (
                
                  ...
                  
                  [ p.itemId, sku ]
                  
                    .filter ( e => e )
                    
                  );
                  
                data.response = Promise.resolve ( );
                
                } else {
                
                  const url = detailsElement
                  
                    .querySelector ( '.product-title' )
                    
                    .getAttribute ( 'href' )
                    
                    +
                    
                    '?format=json';
                    
                  data.response = fetch ( url )
                  
                    .then ( ( response ) => {
                    
                      if ( ! response.ok ) {
                      
                        const s = `
                        
                          ${ codeKey } network response was not ok ${
                          
                            response
                              
                              .statusText
                              
                              }
                              
                          `
                          
                          .trim ( )
                          
                          .replace ( /\s+/gm, ' ' );
                          
                        throw new Error ( s );
                        
                        }
                        
                      const obj = response.json ( );
                      
                      return obj;
                      
                      } )
                      
                    .then ( ( obj ) => {
                    
                      const
                      
                        item = obj.item,
                        
                        l = item.variants.length;
                        
                      itemId = item.id;
                      
                      if ( l ) {
                      
                        const callback = ( variant ) => {
                        
                          const optionOrdering
                          
                            =
                            
                            item
                            
                              .variantOptionOrdering;
                              
                          let obj = { };
                          
                          if ( optionOrdering.length )
                          
                            obj = optionOrdering
                            
                              .reduce ( ( acc, key ) => {
                              
                                if ( key in variant.attributes )
                                
                                  acc [ key ] = variant.attributes [ key ];
                                  
                                return acc;
                                
                                }, { } );
                                
                          variants [
                          
                            JSON.stringify ( obj )
                            
                            ]
                            
                            =
                            
                            variant
                            
                              .sku;
                              
                          };
                          
                        variants = { };
                        
                        item
                        
                          .variants
                          
                          .forEach ( callback );
                          
                        }
                        
                      switch ( true ) {
                      
                        case ! variants :
                        
                          break;
                          
                        case l === 1 :
                        
                          sku = variants [ '{}' ];
                          
                          break;
                          
                        case l > 1 : {
                        
                          if ( isVariantSelected ) {
                          
                            setAttributes ( );
                            
                            setVariantSku ( );
                            
                            }
                            
                          break;
                          
                          }
                          
                        }
                        
                      data.ids.push (
                      
                        ...
                        
                        [ itemId, sku ]
                        
                          .filter ( e => e )
                          
                        );
                        
                      element.twcPbftfml = {
                      
                        itemId : itemId,
                        
                        variants : variants
                        
                        };
                        
                      } );
                      
                  }
                  
              },
              
            selector = '.sqs-block[ data-definition-name="'
            
              +
              
              'website.components.product" ]:not( :has( .product-block '
              
              +
              
              '.image-container .product-mark.sold-out ) ) '
              
              +
              
              '.sqs-add-to-cart-button-wrapper';
              
          document
          
            .querySelectorAll ( selector )
            
            .forEach ( e =>
            
              e.addEventListener ( 'click', handleEvent )
              
              );
              
          };
          
        document.addEventListener ( 'DOMContentLoaded', callback );
        
        } ) ( );
        
      </script>
      
    <!-- end TWC Product Block Form Text Field Max Length -->
  
  <!-- begin TWC Store Page Form Text Field Max Length -->
  
    <!--
    
      store page form text field max length
      
      License         : < https://tinyurl.com/s872fb68 >
      
      Version         : 0.3.3
      
      SS Versions     : 7.1, 7.0
      
      v7.1
      Products V2
      Compatible      : Yes
      
      v7.1
      Fluid
      Engine
      Compatible      : Not Applicable
      
      v7.0 Templates  : Brine ( Aria, Blend, Burke, Cacao, Clay, Fairfield, Feed,
                        Foster, Greenwich, Hatch, Heights, Hunter, Hyde, Impact,
                        Jaunt, Juke, Keene, Kin, Lincoln, Maple, Margot, Marta,
                        Mentor, Mercer, Miller, Mojave, Moksha, Motto, Nueva,
                        Pedro, Pursuit, Rally, Rover, Royce, Sofia, Sonora,
                        Stella, Thorne, Vow, Wav, West )
                        
                        your template is not listed? then it is not currently
                        supported
      
      Dependencies    : product custom form text field max length
      
      Notes           : this code does not work on the checkout page. it is a
                        Squarespace security feature that no code can alter the
                        checkout page
                        
                        this code is client side and making use of an HTML form
                        feature. Since this code is client side it is possible to
                        bypass the max length limit this code is setting. in other
                        words you still need to be checking manually when forms or
                        orders come in to make sure your limits are not being
                        exceeded. consider this code more of an aid to help users
                        not exceed your field max length limits
      
      Copyright       : 2024-2025 Thomas Creedon
                        
                        Tom's Web Consulting < http://www.tomsWeb.consulting/ >
      
      no user serviceable parts below
      
      -->
      
      <script>
      
        ( ( ) => {
        
          const
          
            version = '0.3.3',
            
            s = `Store Page Form Text Field Max Length v${ version }
            
              License < https://tinyurl.com/s872fb68 >
              
              Â© 2024-2025 Thomas Creedon
              
              Tom's Web Consulting < http://www.tomsWeb.consulting >`
              
              .replace ( /^\s+/gm, '' );
              
          console.log ( s );
          
          const callback = ( ) => {
          
            const isStorePage = Static
            
              .SQUARESPACE_CONTEXT
              
              .collection
              
              ?.type
              
              ===
              
              13;
              
            if ( ! isStorePage ) return; // bail if not store page
            
            // globals
            
            {
            
              // initialize twc module
              
              window.twc = ( ( self ) => self ) ( window.twc || { } );
              
              // initialize twc ftfml sub-module
              
              twc.ftfml = ( ( self ) => {
              
                const options = {
                
                  ids : undefined,
                  
                  response : undefined
                  
                  };
                  
                Object
                
                  .assign (
                  
                    self,
                    
                    options
                    
                    );
                    
                return self;
                
                } ) ( twc.ftfml || { } );
                
              }
              
            const
            
              codeKey = `twc-spftfml`,
              
              detail = ( ) => {
              
                const
                
                  callback = ( element ) => {
                  
                    const callback = async ( event ) => {
                    
                      const
                      
                        addOnClassName = 'add-on-card',
                        
                        data = twc.ftfml,
                        
                        element = event
                        
                          .target
                          
                          .closest (
                          
                            [
                            
                              `.${ addOnClassName }`,
                              
                              '.product-detail'
                              
                              ]
                              
                              .join ( ', ' )
                              
                            ),
                            
                        isAddOn = element
                        
                          .classList
                          
                          .contains ( addOnClassName );
                          
                      let
                      
                        context,
                        
                        variants;
                        
                      if ( ! isAddOn ) {
                      
                        context = Static.SQUARESPACE_CONTEXT,
                        
                        variants = context
                        
                          .product
                          
                          .variants;
                          
                        } else {
                        
                          try {
                          
                            const
                            
                              url = element
                              
                                .querySelector ( '.add-on-title-link' )
                                
                                .getAttribute ( 'href' )
                                
                                +
                                
                                '?format=json',
                                
                              response = await fetch ( url );
                              
                            if ( ! response.ok ) {
                            
                              const s = `
                              
                                ${ codeKey } network response was not ok ${
                                
                                  response
                                  
                                    .statusText
                                    
                                    }
                                    
                                `
                                
                                .trim ( )
                                
                                .replace ( /\s+/gm, ' ' );
                                
                              throw new Error ( s );
                              
                              }
                              
                            context = await response.json ( );
                            
                            variants = context.item.variants;
                            
                            } catch ( error ) {
                            
                              const s = `
                              
                                ${ codeKey } there has been a problem with your fetch get operation,
                                
                                ${ error }.
                                
                                `
                                
                                .trim ( )
                                
                                .replace ( /\s+/gm, ' ' );
                                
                              console.error ( s );
                              
                              }
                              
                          }
                          
                      data.ids = [ context.itemId ];
                      
                      if ( ! variants ) { // bail if no variants
                      
                        data.response = Promise.resolve ( );
                        
                        return;
                        
                        }
                        
                      let sku;
                      
                      if ( variants.length === 1 )
                      
                        sku = variants [ 0 ].sku;
                        
                        else {
                        
                          const variantsElement = element
                            
                            .querySelector ( '.product-variants' );
                            
                          switch ( true ) {
                          
                            case is71 : {
                            
                              const
                              
                                elements = variantsElement
                                
                                  .querySelectorAll (
                                  
                                    '.variant-select-wrapper'
                                    
                                    ),
                                    
                                isVariantSelected
                                
                                  =
                                  
                                  !
                                  
                                  [
                                  
                                    ...
                                    
                                    elements
                                    
                                    ]
                                  
                                    .filter (
                                    
                                      e => e
                                      
                                        .getAttribute ( 'data-selected-value' )
                                        
                                        .startsWith ( 'Select ' )
                                        
                                      )
                                      
                                      .length;
                                  
                              // bail if no variant selected
                              
                              if ( ! isVariantSelected ) return;
                              
                              const
                              
                                attributes = { },
                                
                                callback = ( element ) => {
                                
                                  attributes
                                  
                                    [
                                    
                                      element
                                      
                                        .closest ( '.variant-option' )
                                        
                                        .getAttribute (
                                        
                                          'data-variant-option-name'
                                          
                                          )
                                          
                                      ]
                                      
                                    =
                                    
                                    value = element
                                    
                                      .getAttribute ( 'data-selected-value' );
                                      
                                  };
                                  
                              elements
                              
                                .forEach ( callback );
                                
                              sku = variants
                              
                                .filter (
                                
                                  v =>
                                  
                                    objectsShallowEqual (
                                    
                                      v.attributes,
                                      
                                      attributes
                                      
                                      )
                                      
                                  )
                                  
                                [ 0 ]
                                
                                .sku;
                                
                              break;
                              
                              }
                              
                            case is70 : {
                            
                              sku = variantsElement
                              
                                .getAttribute ( 'data-selected-variant' );
                                
                              if ( ! sku ) return; // bail if no sku
                              
                              sku = JSON
                              
                                .parse ( sku )
                                
                                .sku;
                                
                              break;
                              
                              }
                              
                            }
                            
                          }
                          
                      data.ids.push ( sku );
                      
                      data.response = Promise.resolve ( );
                      
                      };
                      
                    element
                    
                      .addEventListener ( 'click', callback );
                      
                    },
                    
                  selector = [
                  
                    // 7.1
                    
                    '.product-detail:not( .product-related-products )'
                    
                      +
                      
                      ':has( :not( .product-mark.sold-out ) ) '
                      
                      +
                      
                      '.sqs-add-to-cart-button-wrapper',
                      
                    // 7.0
                    
                    '.ProductItem:not( .sold-out ) '
                    
                      +
                      
                      '.sqs-add-to-cart-button-wrapper '
                      
                      +
                      
                      '.sqs-add-to-cart-button.use-form'
                      
                    ]
                    
                    .join ( ', ' );
                    
                document
                
                  .body
                  
                  .querySelectorAll ( selector )
                  
                  .forEach ( callback );
                  
                },
                
              isDetail = ( ( ) => {
              
                const
                
                  selector = 'body[ id^="item-" ]',
                  
                  is = document
                  
                    .querySelector ( selector )
                    
                    !==
                    
                    null;
                    
                return is;
                
                } ) ( ),
                
              isList = ( ( ) => {
              
                const
                
                  selector = 'body[ id^="collection-" ]',
                  
                  is = document
                  
                    .querySelector ( selector )
                    
                    !==
                    
                    null;
                    
                return is;
                
                } ) ( ),
                
              list = ( ) => {
              
                const callback = ( data ) => {
                  
                  const callback = ( item ) => {
                  
                    const hasForm = item
                    
                      .additionalFieldsFormId;
                      
                    if ( ! hasForm ) return; // bail if no form
                    
                    const variantOptionsLength = item
                    
                      .variantOptionOrdering
                      
                      .length;
                      
                    // bail if more than one option
                    
                    if ( variantOptionsLength > 1 ) return;
                    
                    const
                    
                      selector = '.product-list-item:has( '
                      
                        +
                        
                        `.product-list-item-link[ href="${ item.fullUrl }" ] ) `
                        
                        +
                        
                        '.sqs-add-to-cart-button-wrapper',
                        
                      element = document
                      
                        .body
                        
                        .querySelector ( selector );
                        
                    if ( ! element ) return; // bail if no element
                    
                    element
                    
                      .setAttribute ( 'data-item-id', item.id );
                      
                    const
                    
                      callback = ( event ) => {
                      
                        const
                        
                          data = twc.ftfml,
                          
                          element = event
                          
                            .currentTarget,
                            
                          itemId = element
                          
                            .getAttribute ( 'data-item-id' ),
                            
                          noSku = element
                          
                            .getAttribute ( noSkuAttribute );
                            
                        data.ids = [ itemId ];
                        
                        if ( noSku ) { // bail if no sku
                        
                          data.response = Promise.resolve ( );
                          
                          return;
                          
                          }
                          
                        let sku = element
                        
                          .getAttribute ( `data-${ codeKey }-sku` );
                          
                        if ( sku ) { // bail if sku
                        
                          data.ids.push ( sku );
                          
                          data.response = Promise.resolve ( );
                          
                          return;
                          
                          }
                          
                        const variantsElement = element
                          
                          .closest ( '.product-list-item' )
                          
                          .querySelector ( '.product-variants' );
                          
                        if ( ! variantsElement ) return; // bail if no variants
                        
                        const
                        
                          elements = variantsElement
                          
                            .querySelectorAll (
                            
                              '.variant-select-wrapper'
                              
                              ),
                              
                          isVariantSelected
                          
                            =
                            
                            !
                            
                            [
                            
                              ...
                              
                              elements
                              
                              ]
                            
                              .filter (
                              
                                e => e
                                
                                  .getAttribute ( 'data-selected-value' )
                                  
                                  .startsWith ( 'Select ' )
                                  
                                )
                                
                                .length;
                                
                        // bail if no variant selected
                        
                        if ( ! isVariantSelected ) return;
                        
                        const
                        
                          attributes = { },
                          
                          callback = ( element ) => {
                          
                            attributes
                            
                              [
                              
                                element
                                
                                  .closest ( '.variant-option' )
                                  
                                  .getAttribute (
                                  
                                    'data-variant-option-name'
                                    
                                    )
                                    
                                ]
                                
                              =
                              
                              value = element
                              
                                .getAttribute ( 'data-selected-value' );
                                
                            };
                            
                        elements
                        
                          .forEach ( callback );
                          
                        sku = variants
                        
                          .filter (
                          
                            v =>
                            
                              objectsShallowEqual (
                              
                                v.attributes,
                                
                                attributes
                                
                                )
                                
                            )
                            
                          [ 0 ]
                          
                          .sku;
                          
                        data.ids.push ( sku );
                        
                        data.response = Promise.resolve ( );
                        
                        },
                        
                      noSkuAttribute = `data-${ codeKey }-no-sku`,
                      
                      variants = item.variants,
                      
                      variantsLength = variants.length;
                      
                    if ( ! variantsLength )
                    
                      element
                      
                        .setAttribute ( noSkuAttribute, '' );
                        
                      else if ( variantsLength === 1 ) {
                      
                        const
                        
                          variant = variants [ 0 ],
                          
                          isNoStock =
                          
                            !
                            
                            variant.unlimited
                            
                            &&
                            
                            !
                            
                            variant.qtyInStock;
                            
                        if ( isNoStock ) return; // bail no stock
                        
                        element
                        
                          .setAttribute (
                          
                            `data-${ codeKey }-sku`,
                            
                            variant.sku
                            
                            );
                            
                        }
                        
                    element
                    
                      .addEventListener ( 'click', callback );
                      
                    };
                    
                  data
                  
                    .items
                    
                    .forEach ( callback );
                    
                  };
                  
                const url = location
                
                  .pathname
                  
                  +
                  
                  '?format=json';
                  
                fetch ( url )
                
                  .then ( response => response.json ( ) )
                  
                  .then ( callback );
                    
                },
                
              objectsShallowEqual = ( obj1, obj2 ) => {
              
                const
                
                  keys1 = Object.keys ( obj1 ),
                  
                  keys2 = Object.keys ( obj2 );
                  
                let isEqual = keys1.length === keys2.length;
                
                // bail id keys lengths not equal
                
                if ( ! isEqual ) return false;
                
                for ( let key of keys1 ) {
                
                  isEqual = obj1 [ key ] === obj2 [ key ];
                  
                  // bail if key/value pair not equal
                  
                  if ( ! isEqual ) return false;
                  
                  }
                  
                return true;
                
                },
                
              ssVersion = Static
              
                .SQUARESPACE_CONTEXT
                
                .templateVersion,
                
              is70 = ssVersion === '7',
              
              is71 = ssVersion === '7.1';
              
            switch ( true ) {
            
              case isDetail:
              
                detail ( );
                
                break;
                
              case isList:
              
                if ( ! is71 ) return; // bail if not 7.1
                
                list ( );
                
                break;
                
              }
              
            };
            
          document.addEventListener ( 'DOMContentLoaded', callback );
          
          } ) ( );
          
        </script>
        
    <!-- end TWC Store Page Form Text Field Max Length -->
  
  <!-- begin TWC Product Custom Form Text Field Max Length -->
  
    <!--
    
      product custom form text field max length
      
      License         : < https://tinyurl.com/s872fb68 >
      
      Version         : 0.1.1
      
      SS Versions     : 7.1, 7.0
      
      v7.1
      Fluid
      Engine
      Compatible      : Not Applicable
      
      v7.0 Templates  : Brine ( Aria, Blend, Burke, Cacao, Clay, Fairfield, Feed,
                        Foster, Greenwich, Hatch, Heights, Hunter, Hyde, Impact,
                        Jaunt, Juke, Keene, Kin, Lincoln, Maple, Margot, Marta,
                        Mentor, Mercer, Miller, Mojave, Moksha, Motto, Nueva,
                        Pedro, Pursuit, Rally, Rover, Royce, Sofia, Sonora,
                        Stella, Thorne, Vow, Wav, West )
                        
                        your template is not listed? then it is not currently
                        supported
      
      Dependencies    : modal lightbox observe changes
                        
                        product quick view form text field max length
      
      Notes           : this code does not work on the checkout page. it is a
                        Squarespace security feature that no code can alter the
                        checkout page
                        
                        this code is client side and making use of an HTML form
                        feature. Since this code is client side it is possible to
                        bypass the max length limit this code is setting. in other
                        words you still need to be checking manually when forms or
                        orders come in to make sure your limits are not being
                        exceeded. consider this code more of an aid to help users
                        not exceed your field max length limits
      
      Copyright       : 2024-2025 Thomas Creedon
                        
                        Tom's Web Consulting < http://www.tomsWeb.consulting/ >
      
      no user serviceable parts below
      
      -->
      
    <style>
    
      .sqs-async-form-content .form-wrapper .field-list .field .field-element[ placeholder*="ftfml" ] {
      
        visibility : hidden;
        
        }
        
      </style>
      
    <script>
    
      ( ( ) => {
      
        const
        
          version = '0.1.1',
          
          s = `Product Custom Form Text Field Max Length v${ version }
          
            License < https://tinyurl.com/s872fb68 >
            
            Â© 2024-2025 Thomas Creedon
            
            Tom's Web Consulting < http://www.tomsWeb.consulting >`
            
            .replace ( /^\s+/gm, '' );
            
        console.log ( s );
        
        // globals
        
        {
        
          // initialize twc module
          
          window.twc = ( ( self ) => self ) ( window.twc || { } );
          
          // initialize twc ftfml sub-module
          
          twc.ftfml = ( ( self ) => {
          
            const options = {
            
              ids : undefined,
              
              response : undefined
              
              };
              
            Object
            
              .assign (
              
                self,
                
                options
                
                );
                
            return self;
            
            } ) ( twc.ftfml || { } );
            
          }
          
        } ) ( );
        
      var twcPcftfml = ( node ) => {
      
        const
        
          codeKey = `twc-pcftfml`,
          
          selector = '.form-wrapper input[ placeholder*="ftfml" ]',
          
          elements = node
          
            .querySelectorAll ( selector );
            
        if ( ! elements.length ) return; // bail if no elements
        
        const callback = ( ) => {
        
          const callback = ( element ) => {
          
            const
            
              attribute = 'placeholder',
              
              re = /^ftfml\s*:\s*{([^}]+)}\s*/;
            
            let
            
              text = element
              
                .getAttribute ( attribute ),
                
              m = text.match ( re );
              
            // clean up placeholder attribute value
            
            {
            
              text = text
              
                .replace ( m [ 0 ], '' )
                
                .trim ( );
                
              if ( text ) // set/show placeholder or remove
              
                element
                
                  .setAttribute ( attribute, text );
                  
                else
                
                  element.removeAttribute ( attribute );
                  
              }
              
            let maxLength = m [ 1 ].trim ( );
            
            if ( isNaN ( maxLength ) ) {
            
              const callback = ( key ) => {
              
                const b = ! twc
                
                  .ftfml
                  
                  .ids
                  
                  .includes ( key );
                  
                if ( b ) return; // bail if no key
                
                maxLength = idMaxlengthMap [ key ];
                
                };
                
              const
              
                json = '{' +
                
                  maxLength
                  
                    .replace ( /[\s]/g, '' )
                    
                    .split ( ',' )
                    
                    .map ( s => s.replace ( /([^:]+)/, '"$1"' ) )
                    
                    .join ( ',' ) +
                    
                  '}',
                  
                key = 'default',
                
                idMaxlengthMap = JSON.parse ( json );
                
              maxLength = '';
              
              if ( key in idMaxlengthMap )
              
                maxLength = idMaxlengthMap [ key ];
                
              Object
              
                .keys ( idMaxlengthMap )
                
                .forEach ( callback );
                
              }
              
            if ( maxLength )
            
              element
              
                .setAttribute ( 'maxlength', maxLength );
                
            };
            
          elements.forEach ( callback );
          
          };
          
        twc
        
          .ftfml
          
          .response
          
          .finally ( callback );
          
        };
        
      </script>
      
    <!-- end TWC Product Custom Form Text Field Max Length -->
  
  <!-- begin TWC Product Quick View Form Text Field Max Length -->
  
    <!--
    
      product quick view form text field max length
      
      License         : < https://tinyurl.com/s872fb68 >
      
      Version         : 0.1.1
      
      SS Versions     : 7.1, 7.0
      
      v7.1
      Fluid
      Engine
      Compatible      : Not Applicable
      
      v7.0 Templates  : Brine ( Aria, Blend, Burke, Cacao, Clay, Fairfield, Feed,
                        Foster, Greenwich, Hatch, Heights, Hunter, Hyde, Impact,
                        Jaunt, Juke, Keene, Kin, Lincoln, Maple, Margot, Marta,
                        Mentor, Mercer, Miller, Mojave, Moksha, Motto, Nueva,
                        Pedro, Pursuit, Rally, Rover, Royce, Sofia, Sonora,
                        Stella, Thorne, Vow, Wav, West )
                        
                        your template is not listed? then it is not currently
                        supported
      
      Dependencies    : product quick view observe changes
      
      Notes           : this code does not work on the checkout page. it is a
                        Squarespace security feature that no code can alter the
                        checkout page
                        
                        this code is client side and making use of an HTML form
                        feature. Since this code is client side it is possible to
                        bypass the max length limit this code is setting. in other
                        words you still need to be checking manually when forms or
                        orders come in to make sure your limits are not being
                        exceeded. consider this code more of an aid to help users
                        not exceed your field max length limits
      
      Copyright       : 2024-2025 Thomas Creedon
                        
                        Tom's Web Consulting < http://www.tomsWeb.consulting/ >
      
      no user serviceable parts below
      
      -->
      
    <script>
    
      ( ( ) => {
      
        const
        
          title = 'Product Quick View Form Text Field Max Length',
          
          version = '0.1.1',
          
          s = `${ title } v${ version }
          
            License < https://tinyurl.com/s872fb68 >
            
            Â© 2024-2025 Thomas Creedon
            
            Tom's Web Consulting < http://www.tomsWeb.consulting >`
            
            .replace ( /^\s+/gm, '' );
            
        console.log ( s );
        
        // globals
        
        {
        
          // initialize twc module
          
          window.twc = ( ( self ) => self ) ( window.twc || { } );
          
          // initialize twc ftfml sub-module
          
          twc.ftfml = ( ( self ) => {
          
            const options = {
            
              ids : undefined,
              
              response : undefined
              
              };
              
            Object
            
              .assign (
              
                self,
                
                options
                
                );
                
            return self;
            
            } ) ( twc.ftfml || { } );
            
          }
          
        } ) ( );
        
      var twcPqvftfml = ( element ) => {
      
        const
        
          handleEvent = ( event ) => {
          
            const
            
              data = twc.ftfml,
              
              element = event
              
                .currentTarget,
                
              metaElement = element
              
                .closest (
                
                  [
                  
                    '.product-meta', // 7.1
                    
                    '.ProductItem-details' // 7.0
                    
                    ]
                    
                    .join ( ', ' )
                    
                  ),
                  
              setAttributes = ( ) => {
              
                const callback = ( element ) => {
                
                  attributes
                  
                    [
                    
                      element
                      
                        .getAttribute ( 'data-variant-option-name' )
                        
                      ]
                      
                    =
                    
                    element
                    
                      .querySelector ( 'select' )
                      
                      .value;
                      
                  };
                  
                variantElements
                
                  .forEach ( callback );
                  
                },
                
              setVariantSku = ( ) => {
              
                sku = variants [
                
                  JSON
                  
                    .stringify (
                    
                      attributes
                      
                      )
                      
                  ];
                  
                },
                
              variantElements
              
                =
                
                metaElement
                
                  .querySelectorAll ( '.product-variants .variant-option' ),
                  
              isVariantSelected
              
                =
                
                variantElements
                
                  .length
                  
                &&
                
                !
                
                [
                
                  ...
                  
                  variantElements
                  
                  ]
                
                  .filter ( e => ! e.querySelector ( 'select' )?.value )
                  
                  .length;
                  
            let
            
              attributes = { },
              
              itemId,
              
              sku,
              
              variants;
              
            data.ids = [ ];
            
            if ( element.twcPqvftfml ) {
            
              const p = element.twcPqvftfml;
              
              itemId = p.itemId;
              
              variants = p.variants;
              
              const l = variants
              
                &&
                
                Object
                
                  .keys ( variants )
                  
                  .length;
                  
              switch ( true ) {
              
                case ! variants :
                
                  break;
                  
                case l === 1 :
                
                  sku = variants [ '{}' ];
                  
                  break;
                  
                case l > 1 : {
                
                  if ( isVariantSelected ) {
                  
                    setAttributes ( );
                    
                    setVariantSku ( );
                    
                    }
                    
                  break;
                  
                  }
                  
                }
                
              data.ids.push (
              
                ...
                
                [ p.itemId, sku ]
                
                  .filter ( e => e )
                  
                );
                
              data.response = Promise.resolve ( );
              
              } else {
              
                const url = metaElement
                
                  .querySelector (
                  
                    [
                    
                      '.quick-view-item-link', // 7.1
                      
                      '.ProductItem-details-quickViewFullItemLink' // 7.0
                      
                      ]
                      
                      .join ( ', ' )
                      
                    )
                    
                  .getAttribute ( 'href' )
                  
                  +
                  
                  '?format=json';
                  
                data.response = fetch ( url )
                
                  .then ( ( response ) => {
                  
                    if ( ! response.ok ) {
                    
                      const s = `
                      
                        ${ codeKey } network response was not ok ${
                        
                          response
                          
                            .statusText
                            
                            }
                            
                        `
                        
                        .trim ( )
                        
                        .replace ( /\s+/gm, ' ' );
                        
                      throw new Error ( s );
                      
                      }
                      
                    const obj = response.json ( );
                    
                    return obj;
                    
                    } )
                    
                  .then ( ( obj ) => {
                  
                    const
                    
                      item = obj.item,
                      
                      l = item.variants.length;
                      
                    itemId = item.id;
                    
                    if ( l ) {
                    
                      const callback = ( variant ) => {
                      
                        const optionOrdering
                        
                          =
                          
                          item
                          
                            .variantOptionOrdering;
                            
                        let obj = { };
                        
                        if ( optionOrdering.length )
                        
                          obj = optionOrdering
                          
                            .reduce ( ( acc, key ) => {
                            
                              if ( key in variant.attributes )
                              
                                acc [ key ] = variant.attributes [ key ];
                                
                              return acc;
                              
                              }, { } );
                              
                        variants [
                        
                          JSON.stringify ( obj )
                          
                          ]
                          
                          =
                          
                          variant
                          
                            .sku;
                            
                        };
                        
                      variants = { };
                      
                      item
                      
                        .variants
                        
                        .forEach ( callback );
                        
                      }
                      
                    switch ( true ) {
                    
                      case ! variants :
                      
                        break;
                        
                      case l === 1 :
                      
                        sku = variants [ '{}' ];
                        
                        break;
                        
                      case l > 1 : {
                      
                        if ( isVariantSelected ) {
                        
                          setAttributes ( );
                          
                          setVariantSku ( );
                          
                          }
                          
                        break;
                        
                        }
                        
                      }
                      
                    data.ids.push (
                    
                      ...
                      
                      [ itemId, sku ]
                      
                        .filter ( e => e )
                        
                      );
                      
                    element.twcPqvftfml = {
                    
                      itemId : itemId,
                      
                      variants : variants
                      
                      };
                      
                    } );
                    
                }
                
            },
            
          codeKey = `twc-pqvftfml`,
          
          selector = [
          
            // 7.1
            
            '.product-detail:not( :has( .product-mark.sold-out ) ) '
            
              +
              
              '.sqs-add-to-cart-button-wrapper',
              
            // 7.0
            
            '.ProductItem:not( .sold-out ) .sqs-add-to-cart-button-wrapper '
            
              +
              
              '.sqs-add-to-cart-button.use-form'
              
            ]
            
            .join ( ', ' );
            
        element = element
          
          .querySelector ( selector );
          
        if ( ! element ) return; // bail if no element
        
        element
        
          .addEventListener ( 'click', handleEvent );
          
        };
        
      </script>
      
    <!-- end TWC Product Quick View Form Text Field Max Length -->
  
  <!-- begin TWC Product Quick View Observe Changes Options -->
  
    <!--
    
      product quick view observe changes options
      
      License      : < https://tinyurl.com/s872fb68 >
      
      Version      : 0.2.0
      
      SS Versions  : 7.1, 7.0
      
      Copyright    : 2024-2025 Thomas Creedon
                     
                     Tom's Web Consulting < http://www.tomsWeb.consulting/ >
      
      -->
      
    <script>
    
      // initialize twc module
      
      window.twc = ( ( self ) => self ) ( window.twc || { } );
      
      // initialize twc pqvoc sub-module
      
      twc.pqvoc = ( ( self ) => self ) ( twc.pqvoc || { } );
      
      // initialize twc pqvoc callbacks sub-module
      
      twc.pqvoc.callbacks = ( ( self ) => {
      
        const callbacks = [
          
          /*
          
            following is an example line. copy and paste it after the example
            line. remove the double forward slash space of the new line. enter the
            name of your callback
            
            */
            
          // '[ enter your callback name here between single quotes replacing square brackets ]',
          
          'twcPqvftfml',
          
          ];
          
        self.push ( ... callbacks );
        
        return self;
        
        } ) ( twc.pqvoc.callbacks || [ ] );
        
      </script>
      
    <!-- end TWC Product Quick View Observe Changes Options -->
  
  <!-- begin TWC Product Quick View Observe Changes -->
  
    <!--
    
      product quick view observe changes
      
      License       : < https://tinyurl.com/s872fb68 >
      
      Version       : 0.2.0
      
      SS Versions   : 7.1, 7.0
      
      v7.1
      Products V2
      Compatible    : Yes
      
      v7.1
      Fluid
      Engine
      Compatible    : Not Applicable
      
      Dependencies  : modal lightbox observe changes
                      
                      < https://tinyurl.com/2pfvaeud >
      
      Note          : this code is a base for other effects. on its own it doesn't
                      do anything. this code is not the end all be all of mutation
                      observers. it may not cover your needs
      
      Copyright     : 2024-2025 Thomas Creedon
                      
                      Tom's Web Consulting < http://www.tomsWeb.consulting/ >
      
      no user serviceable parts below
      
      -->
      
    <script>
    
      ( ( ) => {
      
        const
        
          version = '0.2.0',
          
          s = `Product Quick View Observe Changes v${ version }
          
            License < https://tinyurl.com/s872fb68 >
            
            Â© 2024-2025 Thomas Creedon
            
            Tom's Web Consulting < http://www.tomsWeb.consulting >`
            
            .replace ( /^\s+/gm, '' );
            
        console.log ( s );
        
        // globals
        
        {
        
          // initialize twc module
          
          window.twc = ( ( self ) => self ) ( window.twc || { } );
          
          // initialize twc pqvoc sub-module
          
          twc.pqvoc = ( ( self ) => self ) ( twc.pqvoc || { } );
          
          // initialize twc pqvoc callbacks sub-module
          
          twc.pqvoc.callbacks =
          
            ( ( self ) => self ) ( twc.pqvoc.callbacks || [ ] );
            
          }
          
        } ) ( );
        
      var twcPqvoc = ( node ) => {
      
        const isQuickView = node
        
          .classList
          
          .contains ( 'sqs-product-quick-view-lightbox' );
          
        if ( ! isQuickView ) return; // bail if no product quick view
        
        const
        
          callback = ( mutations ) => {
          
            const callback = ( mutation ) => {
            
              let hasAdded = mutation.addedNodes.length;
              
              if ( ! hasAdded ) return; // continue
              
              const
              
                element = mutation
                
                  .addedNodes
                  
                  [ 0 ],
                  
                isProduct = [
                
                  'product-detail', // 7.1
                  
                  'ProductItem' // 7.0
                  
                  ]
                  
                  .some ( c => element.classList.contains ( c ) );
                  
              if ( ! isProduct ) return; // bail if not product item
              
              const callback = ( callback ) => {
              
                try {
                
                  callback = window [ callback ];
                  
                  callback ( element );
                  
                  } catch ( error ) {
                  
                    const s = `${ codeKey } callback error`;
                    
                    console.error ( s, error );
                    
                    }
                    
                };
                
              options
              
                .callbacks
                
                .forEach ( callback );
                
              };
              
            mutations.forEach ( callback );
            
            },
            
          codeKey = 'twc-pqvoc',
          
          config = {
          
            childList : true
            
            },
            
          observer = new MutationObserver ( callback ),
          
          options = codeKey
          
            .split ( '-' )
            
            .reduce ( ( obj, key ) => obj?.[ key ], window ),
            
          selector = '.sqs-product-quick-view-content',
          
          element = node
          
            .querySelector ( selector );
            
        // start listening for changes in element
        
        observer.observe ( element, config );
        
        };
        
      </script>
      
    <!-- end TWC Product Quick View Observe Changes -->
  
  <!--
  
    begin modal lightbox observe changes
    
    License       : < https://tinyurl.com/s872fb68 >
    
    Version       : 0.1.1
    
    SS Versions   : 7.1, 7.0
    
    v7.1
    Fluid
    Engine
    Compatible    : Not Applicable
    
    Note          : this code is a base for other effects. on its own it
                    doesn't do anything. this code is not the end all be all
                    of mutation observers. it may not cover your needs
    
    By            : Thomas Creedon < http://www.tomsWeb.consulting/ >
    
    -->
    
    <script>
      
      if ( window.twc == undefined ) window.twc = { };
      
      twc.mloc = {
      
        callbacks : [
        
          /*
          
            following is an example line. copy and paste it after the example
            line. remove the double forward slash space of the new line. replace
            the name with your callback
            
            */
            
          // '[ enter your callback name here replacing square brackets ]',
          
          'twcPqvoc',
          
          'twcPcftfml',
          
          ]
          
        };
        
      </script>
      
    <!-- do not change anything below, there be the borg here -->
    
    <script>
    
      document.addEventListener ( 'DOMContentLoaded', ( ) => {
      
        const version = '0.1.1';
        
        const s = `Modal Lightbox Observe Changes v${ version }, ` +
        
          'License < https://tinyurl.com/s872fb68 >, ' +
          
          'Tom\'s Web Consulting < http://www.tomsWeb.consulting >';
          
        console.log ( s );
        
        const callback = ( mutations ) => {
        
          const callback = ( mutation ) => {
          
            const callback = ( node ) => {
            
              const b = ! node
              
                .classList
                
                .contains ( 'sqs-modal-lightbox' );
                
              if ( b ) return; // bail if not element of interest
              
              const callback = ( callback ) => {
              
                try {
                
                  callback = window [ callback ];
                  
                  callback ( node );
                  
                  } catch ( error ) {
                  
                    const s = `${ codeKey } callback error`;
                    
                    console.error ( s, error );
                    
                    }
                    
                };
                
              twc
              
                [ codeKeySuffix ]
                
                .callbacks
                
                .forEach ( callback );
                
              };
              
            mutation
            
              .addedNodes
              
              .forEach ( callback );
              
            };
            
          mutations.forEach ( callback );
          
          };
          
        const codeKeySuffix = 'mloc';
        
        const codeKey = `twc-${ codeKeySuffix }`;
        
        const config = {
        
          childList : true
          
          };
          
        const observer = new MutationObserver ( callback );
        
        // start listening for changes in body
        
        observer.observe ( document.body, config );
        
        } );
        
      </script>
      
    <!-- end modal lightbox observe changes -->
  
  <!-- begin TWC Cart Page Form Text Field Max Length -->
  
    <!--
    
      cart page form text field max length
      
      License       : < https://tinyurl.com/s872fb68 >
      
      Version       : 0.1.2
      
      SS Versions   : 7.1, 7.0
      
      v7.1
      Fluid
      Engine
      Compatible    : Not Applicable
      
      Dependencies  : cart page observe changes
      
      Notes         : this code does not work on the checkout page. it is a
                      Squarespace security feature that no code can alter the
                      checkout page
  
                      this code is client side and making use of an HTML form
                      feature. Since this code is client side it is possible to
                      bypass the max length limit this code is setting. in other
                      words you still need to be checking manually when forms or
                      orders come in to make sure your limits are not being
                      exceeded. consider this code more of an aid to help users
                      not exceed your field max length limits
      
      Copyright     : 2024-2025 Thomas Creedon
                      
                      Tom's Web Consulting < http://www.tomsWeb.consulting/ >
      
      no user serviceable parts below
      
      -->
      
    <style>
    
      html:not( .squarespace-damask ) #sqs-cart-container .cart-product-form-wrapper input[ placeholder*="ftfml" ] {
      
        visibility : hidden;
        
        }
        
      </style>
      
    <script>
    
      ( ( ) => {
      
        const
        
          version = '0.1.2',
          
          s = `Cart Page Form Text Field Max Length v${ version }
          
            License < https://tinyurl.com/s872fb68 >
            
            Â© 2024-2025 Thomas Creedon
            
            Tom's Web Consulting < http://www.tomsWeb.consulting >`
            
            .replace ( /^\s+/gm, '' );
            
        console.log ( s );
        
        // globals
        
        {
        
          // initialize twc module
          
          window.twc = ( ( self ) => self ) ( window.twc || { } );
          
          // initialize twc cpftfml sub-module
          
          twc.cpftfml = ( ( self ) => {
          
            const options = {
            
              ids : undefined
              
              };
              
            Object
            
              .assign (
              
                self,
                
                options
                
                );
                
            return self;
            
            } ) ( twc.cpftfml || { } );
            
          }
          
        } ) ( );
        
      var twcCpftfml = ( node ) => {
      
        const hasQuerySelector
        
          =
          
          node
          
            .querySelector;
            
        if ( ! hasQuerySelector ) return; // bail if no querySelector
        
        let selector;
        
        // cart container
        
        ( ( ) => {
        
          const isCartContainerElement
          
            =
            
            node
            
              .classList
              
              .contains ( 'cart-container' );
              
          // bail if not cart container element
          
          if ( ! isCartContainerElement ) return;
          
          selector = '.cart-row';
          
          const
          
            callback = ( element ) => {
            
              const callback = ( event ) => {
              
                console.log ( event );
                
                const
                
                  callback = ( item ) => {
                  
                    console.log ( item );
                    
                    const b = ! ( 'productForm' in item );
                    
                    if ( b ) return [ ]; // bail if no product form
                    
                    const ids = [ item.productId ];
                    
                    if ( item.sku !== undefined )
                    
                      ids.push ( item.sku );
                      
                    return ids;
                    
                    },
                    
                  i = [
                  
                    ...
                    
                    cartRowElements
                    
                    ]
                    
                    .indexOf (
                    
                      element
                      
                        .closest ( '.cart-row' )
                        
                      ),
                      
                  selector =
                  
                    '#sqs-cart-root script[ type="application/json" ]';
                    
                twc.cpftfml.ids = JSON
                
                  .parse (
                  
                    document
                    
                      .body
                      
                      .querySelector ( selector )
                      
                      .textContent
                      
                    )
                    
                  .cart
                  
                  .items
                  
                  .map ( callback )
                  
                  [ i ];
                  
                };
                
              element.addEventListener ( 'click', callback );
              
              },
              
            cartRowElements = node
            
              .querySelectorAll ( selector );
              
          selector = '.cart-row-edit';
          
          node
          
            .querySelectorAll ( selector )
            
            .forEach ( callback );
            
          } ) ( );
          
        // cart product form container
        
        ( ( ) => {
        
          selector = '.cart-product-form-container';
          
          let elements = node
          
            .querySelector ( selector );
            
          if ( ! elements ) return; // bail if no element
          
          const callback = ( element ) => {
          
            const
            
              attribute = 'placeholder',
              
              re = /^ftfml\s*:\s*{([^}]+)}\s*/;
              
            let
            
              text = element
              
                .getAttribute ( attribute ),
                
              m = text.match ( re );
              
            // clean up placeholder attribute value
            
            {
            
              text = text
              
                .replace ( m [ 0 ], '' )
                
                .trim ( );
                
              if ( text ) // set/show placeholder or remove
              
                element
                
                  .setAttribute ( attribute, text );
                  
                else
                
                  element.removeAttribute ( attribute );
                  
              }
              
            let maxLength = m [ 1 ]
            
              .trim ( );
              
            if ( isNaN ( maxLength ) ) {
            
              const callback = ( key ) => {
              
                const b = ! twc
                
                  .cpftfml
                  
                  .ids
                  
                  .includes ( key );
                  
                if ( b ) return; // bail if no key
                
                maxLength = idMaxlengthMap [ key ];
                
                };
                
              const
              
                json = '{' +
                
                  maxLength
                  
                    .replace ( /[\s]/g, '' )
                    
                    .split ( ',' )
                    
                    .map ( s => s.replace ( /([^:]+)/, '"$1"' ) )
                    
                    .join ( ',' ) +
                    
                  '}',
                  
                key = 'default',
                
                idMaxlengthMap = JSON.parse ( json );
                
              maxLength = '';
              
              if ( key in idMaxlengthMap )
              
                maxLength = idMaxlengthMap [ key ];
                
              Object
              
                .keys ( idMaxlengthMap )
                
                .forEach ( callback );
                
              }
              
            if ( maxLength )
            
              element
              
                .setAttribute ( 'maxlength', maxLength );
                
            };
            
          selector = '.cart-product-form-field-label ' +
          
            'input[ placeholder*="ftfml" ]';
            
          elements = elements
          
            .querySelectorAll ( selector )
            
            .forEach ( callback );
            
          } ) ( );
          
        };
        
      </script>
      
    <!-- end TWC Cart Page Form Text Field Max Length -->
  
  <script>
  
    document.addEventListener ( 'DOMContentLoaded', ( ) => {
    
      /*
      
        cart page observe changes
        
        License       : < https://tinyurl.com/s872fb68 >
        
        Version       : 0.2.2
        
        SS Versions   : 7.1, 7.0
        
        v7.1
        Fluid
        Engine
        Compatible    : Not Applicable
        
        Note          : this code is a base for other effects. on its own it
                        doesn't do anything. this code is not the end all be all
                        of mutation observers. it may not cover your needs
        
        By            : Thomas Creedon < http://www.tomsWeb.consulting/ >
        
        */
        
      const callbacks = {
      
        added : [
        
          /*
          
            following is an example line. copy and paste it after the example
            line. remove the double forward slash space of the new line. replace
            the name with your callback
            
            */
            
          // '[ optional, enter your callback name here replacing square brackets ]',
          
          'twcCpftfml',
          
          ],
          
        removed : [
        
          /*
          
            following is an example line. copy and paste it after the example
            line. remove the double forward slash space of the new line. replace
            the name with your callback
            
            */
            
          // '[ optional, enter your callback name here replacing square brackets ]',
          
          ]
          
        };
        
      // do not change anything below, there be the borg here
      
      const version = '0.2.2';
      
      const s = `Cart Page Observe Changes v${ version }, ` +
      
        'License < https://tinyurl.com/s872fb68 >, ' +
        
        'Tom\'s Web Consulting < http://www.tomsWeb.consulting >';
        
      console.log ( s );
      
      let b = location.pathname != '/cart';
      
      if ( b ) return; // bail if not cart page
      
      b = ! ( 'MutationObserver' in window );
      
      if ( b ) return; // bail if no mutation observer available
      
      const callback = ( mutations ) => {
      
        const callback = ( mutation ) => {
        
          const callback = ( node ) => {
          
            const callback = ( callback ) => {
            
              const cllbck = window [ callback ];
              
              try {
              
                cllbck ( node );
                
                } catch ( error ) {
                
                  const s = `${ codeKey } : ${ callback } `;
                  
                  console.error ( s, error );
                  
                  }
                  
              };
              
            cllbcks.forEach ( callback );
              
            };
            
          const nodesAdded = mutation.addedNodes;
          
          const nodesRemoved = mutation.removedNodes;
          
          let cllbcks;
          
          let nodes;
          
          switch ( true ) {
          
            case Boolean ( nodesAdded.length ):
            
              cllbcks = callbacks.added;
              
              nodes = nodesAdded
              
              break;
              
            case Boolean ( nodesRemoved.length ) :
            
              cllbcks = callbacks.removed;
              
              nodes = nodesRemoved;
              
              break;
              
            }
            
          nodes.forEach ( callback );
          
          };
          
        mutations.forEach ( callback );
        
        };
        
      const codeKey = 'twc-cpoc';
      
      const observer = new MutationObserver ( callback );
        
      const element = document
      
        .getElementById ( 'sqs-cart-container' );
        
      const options = {
      
        childList : true,
        
        subtree : true
        
        };
        
      // begin listening for changes in element
      
      observer.observe ( element, options );
        
      } );
      
    </script>
    
  <!-- end TWC Product Custom Form Text Field Max Length -->
