<script>

  $( ( ) => {
  
    /*
    
      gallery section image order random
      
      License       : < https://tinyurl.com/s872fb68 >
      
      Version       : 0.3.0
      
      SS Version    : 7.1
      
      Dependencies  : jQuery
      
      Copyright     : 2021-2025 Thomas Creedon
                      
                      Tom's Web Consulting < http://www.tomsWeb.consulting/ >
      
      no user serviceable parts below
      
      */
      
    const
    
      version = '0.3.0',
      
      s = `Gallery Section Image Order Random v${ version }
      
        License < https://tinyurl.com/s872fb68 >
        
        Â© 2021-2025 Thomas Creedon
        
        Tom's Web Consulting < http://www.tomsWeb.consulting >`
        
        .replace ( /^\s+/gm, '' );
        
    console.log ( s );
    
    const
    
      codeKey = 'twc-gsior',
      
      selector = '.gallery-section .gallery-caption '
      
        +
        
        `p.gallery-caption-content:contains(${ codeKey })`,
        
      $captionElements = $( selector );
      
    if ( ! $captionElements.length ) return; // bail if no $captionElements
    
    const
    
      captionCallback = function ( ) {
      
        const $this = $( this );
        
        let text = $this
        
          .text ( )
          
          .replace ( codeKey, '' )
          
          .trim ( );
          
        if ( text )
        
          $this
          
            .text ( text )
            
          else
          
            $this
            
              .parents ( 'figcaption' )
              
              .remove ( );
              
        },
        
      galleryCallback = function ( ) {
      
        const
        
          $this = $( this ),
          
          galleryFigureSelector = [
          
            '.gallery-grid-wrapper',
            
            '.gallery-strips-wrapper',
            
            '.gallery-masonry-wrapper',
            
            '.gallery-slideshow-list',
            
            '.gallery-fullscreen-slideshow-list',
            
            '.gallery-reel-list'
            
            ]
            
            .join ( ' figure, ' )
            
            +
            
            ' figure',
            
          lightboxFigureSelector = '.gallery-lightbox-outer-wrapper figure',
          
          sectionId = $this
          
            .attr ( 'data-section-id' );
            
        let
        
          callback = function ( galleryFigureElement ) {
          
            const css = $( galleryFigureElement )
            
              .css ( 'transform' );
              
            return css;
            
            },
            
          $galleryFigureElements = $( galleryFigureSelector, $this )
          
            .removeAttr ( 'data-active' ),
            
          $lightboxFigureElements = $( lightboxFigureSelector, $this ),
          
          map = $.map ( $galleryFigureElements, callback );
          
        callback = function ( ) {
        
          const
          
            r = Math.floor ( Math.random ( ) * $galleryFigureElements.length ),
            
            selector = `[ data-lightbox-section-id="${ sectionId }" ] `
            
              +
              
              'figure',
              
            $galleryFigureElement = $galleryFigureElements.eq ( r ),
            
            $lightboxFigureElement = $lightboxFigureElements.eq ( r );
            
          /* begin append figure element */
          
            $galleryFigureElement
            
              .parent ( )
              
              .append ( $galleryFigureElement )
              
              .css ( map [ r ] );
              
            $galleryFigureElements = $galleryFigureElements
            
              .not ( $galleryFigureElement );
              
            map.splice ( r, 1 );
            
            /* end append figure element */
            
          /* begin append lightbox element */
          
            if ( ! $lightboxFigureElement.length ) return; // bail if no element
            
            $lightboxFigureElement
            
              .parent ( )
              
              .append ( $lightboxFigureElement );
              
            $lightboxFigureElements = $lightboxFigureElements
            
              .not ( $lightboxFigureElement );
              
            // end append lightbox element */
            
          }
          
        $galleryFigureElements.each ( callback );
        
        },
        
      $galleryElements = $captionElements
      
        .parents ( '.gallery-section' );
        
    $captionElements.each ( captionCallback ); // clean up captions
    
    $galleryElements.each ( galleryCallback );
    
    } );
    
  </script>
