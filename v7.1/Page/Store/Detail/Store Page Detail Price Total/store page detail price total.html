<!-- begin TWC Store Page Detail Price Total -->

  <script>
  
    /*
    
      store page detail price total
      
      License       : < https://tinyurl.com/s872fb68 >
      
      Version       : 0.4.0
      
      SS Version    : 7.1
      
      Products V2
      Compatible    : Yes
      
      Fluid
      Engine
      Compatible    : Not Applicable
      
      Dependencies  : store page price change < https://tinyurl.com/5az53zbz >
      
      Copyright     : 2021-2025 Thomas Creedon
                      
                      Tom's Web Consulting < http://www.tomsWeb.consulting/ >
      
      no user serviceable parts below
      
      */
      
      ( ( ) => {
      
        const
        
          version = '0.4.0',
          
          s = `Store Page Detail Price Total v${ version }
          
            License < https://tinyurl.com/s872fb68 >
            
            Â© 2021-2025 Thomas Creedon
            
            Tom's Web Consulting < http://www.tomsWeb.consulting >`
            
            .replace ( /^\s+/gm, '' );
            
        console.log ( s );
        
        } ) ( );
        
      // initialize twc module
      
      window.twc = ( ( self ) => self ) ( window.twc || { } );
      
      // initialize twc spdpt sub-module
      
      twc.spdpt = ( ( self ) => {
      
        const options = {
        
          map : { }
          
          };
          
        Object
        
          .assign (
          
            self,
            
            options
            
            );
            
        return self;
        
        } ) ( twc.spdpt || { } );
        
      // initialize twc sppc sub-module
      
      twc.sppc = ( ( self ) => self ) ( twc.sppc || { } );
      
      // initialize twc sppc callbacks sub-module
      
      twc.sppc.callbacks = ( ( self ) => {
      
        self
        
          .twcSpdpt = ( node, isDetail, text, searchText ) => {
          
            if ( ! isDetail ) return true; // continue if not detail
            
            node = node.parentNode;
            
            const isProductPrice = node
            
              .closest ( '.product-price' );
              
            if ( ! isProductPrice ) return true; // continue
            
            const m = text.match ( searchText );
            
            if ( ! m ) return true; // continue
            
            const
            
              codeKey = 'twc-spdpt',
              
              isFrom = text.includes ( 'from ' ),
              
              options = codeKey
              
                .split ( '-' )
                
                .reduce ( ( obj, key ) => obj?.[ key ], window ),
                
              map = options.map;
              
            m [ 0 ] = parseFloat ( m [ 0 ] );
            
            if ( ! map.from && isFrom ) {
            
              map.from = m [ 0 ];
              
              return true;
              
              }
              
            const
            
              classList = node
              
                .classList,
                
              variantSelectWrapperElements = document
              
                .body
                
                .querySelectorAll ( '.variant-select-wrapper' ),
                
              isOriginal = classList
              
                .contains ( 'original-price' ),
                
              isPrice = classList
              
                .contains ( 'product-price-value' ),
                
              isSale = classList
              
                .contains ( 'sale-price' ),
                
              isVariant = variantSelectWrapperElements.length,
              
              quantity
              
                =
                
                Number (
                
                  document
                  
                    .body
                    
                    .querySelector (
                    
                      '.product-detail .product-meta .product-add-to-cart '
                      
                      +
                      
                      '.product-quantity-input-wrapper input'
                      
                      )
                      
                    .value
                    
                  );
                  
            let
            
              attributes = { },
              
              key;
              
            if ( isVariant ) {
            
              const
              
                isVariantSelected
                
                  =
                  
                  !
                  
                  [
                  
                    ...
                    
                    variantSelectWrapperElements
                      
                    ]
                  
                    .filter (
                    
                      e => e
                      
                        .getAttribute ( 'data-selected-value' )
                        
                        .startsWith ( 'Select ' )
                        
                      )
                      
                    .length;
                    
              if ( isVariantSelected ) {
              
                const callback = ( element ) => {
                
                  attributes
                  
                    [
                    
                      element
                      
                        .closest ( '.variant-option' )
                        
                        .getAttribute ( 'data-variant-option-name' )
                        
                      ]
                      
                    =
                    
                    element
                    
                      .getAttribute ( 'data-selected-value' );
                      
                  };
                  
                variantSelectWrapperElements
                
                  .forEach ( callback );
                  
                }
                
              }
              
            attributes = JSON.stringify ( attributes );
            
            if ( ! map [ attributes ] )
            
              map [ attributes ] = { };
              
            switch ( true ) {
            
              case isOriginal :
              
                key = 'original';
                
                break;
                
              case isPrice :
              
                key = 'price';
                
                break;
                
              case isSale :
              
                key = 'sale';
                
                break;
                
              }
              
            const value = map [ attributes ];
            
            if ( ! value [ key ] )
            
              value [ key ] = m [ 0 ];
              
            const total = (
            
              value [ key ]
              
              *
              
              quantity
              
              )
              
              .toFixed ( 2 );
              
            return total;
            
            };
            
        return self;
        
        } ) ( twc.sppc.callbacks || { } );
        
    </script>
    
  <!-- end TWC Store Page Detail Price Total -->
