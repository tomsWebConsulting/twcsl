<!-- begin TWC Store Page List Category Section Reveal -->

  <!--
  
    store page list category section reveal
    
    License       : < https://tinyurl.com/s872fb68 >
    
    Version       : 0.4.0
    
    SS Version    : 7.1
    
    Products V2
    Compatible    : Yes
    
    Fluid
    Engine
    Compatible    : Yes
    
    Dependencies  : page section first blank hide
    
    Notes         : the code is comprised of a style and script tag. both are
                    needed for the full effect to work
                    
                    the code has a downside in that it is loading page sections
                    that will not be displayed
    
    Copyright     : 2021-2025 Thomas Creedon
                    
                    Tom's Web Consulting < http://www.tomsWeb.consulting/ >
    
    no user serviceable parts below
    
    -->
    
  <style>
  
    body:not( .sqs-is-page-editing ) #page .page-section[ id^="twc-splcsr-" ] {
    
      display : none;
      
      }
      
    body:not( .sqs-is-page-editing ) #page .page-section.twc-splcsr {
    
      display : flex;
      
      }
      
    </style>
    
  <script>
  
    ( ( ) => {
    
      const
      
        version = '0.4.0',
      
        s = `
        
          Store Page List Category Section Reveal v${ version }
          
          License < https://tinyurl.com/s872fb68 >
          
          Â© 2021-2025 Thomas Creedon
          
          Tom's Web Consulting < http://www.tomsWeb.consulting >
          
          `
          
          .replace ( /^\s+/gm, '' );
          
      console.log ( s );
      
      const callback = ( ) => {
      
        const isStorePage = Static
        
          .SQUARESPACE_CONTEXT
          
          .collection
          
          .type
          
          ===
          
          13;
          
        if ( ! isStorePage ) return; // bail if not store page
        
        const isList = ( ( ) => {
        
          const
          
            selector = 'body[ id^="collection-" ]',
            
            is = document
            
              .querySelector ( selector )
              
              !==
              
              null;
              
          return is;
          
          } ) ( );
          
        if ( ! isList ) return; // bail if not list
        
        const
        
          codeKey = 'twc-splcsr',
          
          getCategorUrlSlugArray = ( ) => {
          
            const
            
              fullUrl = Static
              
                .SQUARESPACE_CONTEXT
                
                .collection
                
                .fullUrl,
                
              pathname = location
              
                .pathname,
                
              isAllCategory
              
                =
                
                pathname
                
                ===
                
                fullUrl;
                
            if ( isAllCategory ) return [ ];
            
            const array = pathname
            
              .replace ( fullUrl, '' )
              
              .split ( '/' )
              
              .slice ( 1 );
              
            return array;
            
            },
            
          fragment
          
            = 
          
            getCategorUrlSlugArray ( )
            
              .join ( '-' )
              
            ||
            
            'default',
            
          selector
          
            =
            
            `#page .page-section[ id="${
            
              codeKey
              
              }-${
              
                fragment
                
                }" ]`;
                
        document
        
          .body
          
          .querySelector ( selector )
          
          .classList
          
          .add ( codeKey );
          
        };
        
      document
      
        .addEventListener ( 'DOMContentLoaded', callback );
        
      } ) ( );
      
    </script>
    
  <!-- end TWC Store Page List Category Section Reveal -->
