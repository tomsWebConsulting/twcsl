<!-- begin TWC Customer Account Log In Dialog Change -->

  <!--
  
    customer account log in dialog change
    
    License       : < https://tinyurl.com/s872fb68 >
    
    Version       : 0.8.0
    
    SS Versions   : 7.1, 7.0
    
    Fluid
    Engine
    Compatible    : Not Applicable
    
    Copyright     : 2023-2025 Thomas Creedon
                    
                    Tom's Web Consulting < http://www.tomsWeb.consulting/ >
    
    -->
    
  <x-twc-calidc-style style="display : none;">
  
    [optional, enter css here replacing square brackets]
    
    </x-twc-calidc-style>
    
  <script>
  
    // initialize twc module
    
    window.twc = ( ( self ) => self ) ( window.twc || { } );
    
    twc.calidc = ( ( self ) => { // initialize twc calidc sub-module
    
      self
      
        .title = {
        
          signIn : '[ optional, enter sign in title text here between single quotes replacing square brackets ]',
          
          signUp : '[ optional, enter sign up title text here between single quotes replacing square brackets ]',
          
          pricingPlanNames : {
          
            /*
            
              the format of each line is a pricing plan name and a title. you
              can use the following tag in your title to have the pricing plan
              name replace it to save some typing
              
                [ ppn ]
                
              following is an example line. copy and paste it after the example
              line. remove the double forward slash space from each new line
              
              you can repeat the example line for as many plan names you want to
              change. if you want the same title for all pricing plans, leave
              the plan name blank
              
              */
              
            // '[ enter pricing plan name here between single quotes replacing square brackets ]' : '[ enter name text here between single quotes replacing square brackets ]',
            
            },
            
          passwordReset : '[ optional, enter password reset title text here between single quotes replacing square brackets ]'
          
          };
          
      return self;
      
      } ) ( twc.calidc || { } );
      
    </script>
    
  <!-- do not change anything below, there be the borg here -->
  
  <script>
  
    ( ( ) => {
    
      const
      
        version = '0.8.0',
        
        s = `Customer Account Log In Dialog Change v${ version }
        
          License < https://tinyurl.com/s872fb68 >
          
          © 2023-2025 Thomas Creedon
          
          Tom's Web Consulting < http://www.tomsWeb.consulting >`
          
          .replace ( /^\s+/gm, '' );
          
      console.log ( s );
      
      // bail if no mutation observer available
      
      if ( ! ( 'MutationObserver' in window ) ) return;
      
      // initialize twc calidc callbacks sub-module
      
      twc.calidc.callbacks =
      
        ( ( self ) => self ) ( twc.calidc.callbacks || [ ] );
        
      const callback = ( ) => {
      
        const
        
          flDebug = false,
          
          accountFrameIdValue = 'accountFrame',
        
          callback = ( mutations ) => {
          
            const callback = ( mutation ) => {
            
               // bail if no nodes added
              
              if ( ! mutation.addedNodes.length ) return;
              
              const
              
                element = mutation.addedNodes [ 0 ],
                
                id = element.id;
                
              // bail if not account frame
              
              if ( id !== `${ accountFrameIdValue }` ) return;
              
              const baseUrl = `${ location.protocol }//${ location.host }`;
              
              let url = element
              
                .getAttribute ( 'src' );
                
              url = new URL ( url, baseUrl );
              
              const isLogin = url
              
                .pathname
                
                .startsWith ( '/account/frame' );
                
              if ( ! isLogin ) return; // bail if not log in
              
              load ( element );
              
              };
              
            mutations.forEach ( callback );
            
            },
            
          codeKey = 'twc-calidc',
          
          config = {
          
            childList : true
            
            },
            
          load = ( element ) => {
          
            const
            
              callback = ( event ) => {
              
                const
                
                  element = event.target,
                
                  pathname = element
                    
                    .contentWindow
                    
                    .location
                    
                    .pathname,
                    
                  b = pathname
                  
                    .startsWith ( '/account/frame/login' );
                    
                if ( ! b ) return; // bail if not log in
                
                const
                
                  dcmnt = element
                  
                    .contentDocument,
                    
                  id = 'user-account-login-root',
                  
                  callback = ( mutations ) => {
                  
                    const callback = ( mutation ) => {
                    
                      processMutationRecord ( mutation );
                      
                      };
                      
                    mutations.forEach ( callback );
                    
                    },
                    
                  processMutationRecord = ( mutation ) => {
                  
                    const
                    
                      isCharacterData = mutation
                      
                        .type
                        
                        ===
                        
                        'characterData',
                        
                      isNodesAdded
                      
                        =
                        
                        Boolean (
                        
                          mutation
                          
                            .addedNodes
                            
                            .length
                            
                          );
                          
                    // bail if no nodes added and no character data
                    
                    if ( ! ( isNodesAdded || isCharacterData ) ) return;
                    
                    let
                    
                      isNodeText,
                      
                      node;
                      
                    switch ( true ) {
                    
                      case isCharacterData :
                      
                        node = mutation
                        
                          .target
                          
                          .parentElement;
                          
                        break;
                        
                      case isNodesAdded : {
                      
                        node = mutation
                        
                          .addedNodes
                          
                          [ 0 ];
                          
                        isNodeText = node
                        
                          .nodeName
                          
                          ===
                          
                          '#text';
                          
                        if ( isNodeText )
                        
                          node = node.parentElement;
                          
                        break;
                        
                        }
                        
                      }
                      
                    const isCaptcha
                    
                      =
                      
                      !
                      
                      isNodeText
                      
                      &&
                      
                      node
                      
                        .closest ( '.reCaptchaContainer' );
                        
                    if ( isCaptcha ) return; // bail if captcha
                    
                    const isSpinner
                    
                      =
                      
                      !
                      
                      isNodeText
                      
                      &&
                      
                      node
                      
                        .getAttribute ( 'data-test' )
                        
                      ===
                      
                      'loading-spinner';
                      
                    if ( isSpinner ) return; // bail if spinner
                    
                    node = node
                    
                      .closest ( '#user-account-login-root' )
                      
                      ?.firstChild
                      
                      .firstChild
                      
                      ||
                      
                      node;
                      
                    const formElement = node
                    
                      .querySelector ( 'form' );
                      
                    if ( ! formElement ) return; // bail if no form element
                    
                    const
                    
                      url = new URL ( dcmnt.location.href ),
                      
                      isAccountVerify = url
                      
                        .searchParams
                        
                        .has ( 'loginNewlyVerifiedAccount' ),
                        
                      isPasswordReset = formElement
                      
                        .children
                        
                        .length
                        
                        ===
                        
                        2,
                        
                      isSessionExpired
                      
                        =
                        
                        !
                        
                        isAccountVerify
                        
                        &&
                        
                        url
                        
                          .pathname
                          
                          ===
                          
                          '/account/frame/login/reauthenticate';
                          
                    let
                    
                      selector = 'button[ type="submit" ]' +
                      
                        '[ data-test="login-button" ]',
                        
                      isSignIn = formElement
                      
                        .querySelector ( selector )
                        
                        !==
                        
                        null;
                        
                    selector = 'button[ type="submit" ]' +
                    
                      '[ data-test="create-account-create-button" ]';
                      
                    let isSignUp = formElement
                    
                      .querySelector ( selector )
                      
                      !==
                      
                      null;
                      
                    // bail if not password reset or sign in or up
                    
                    if ( ! ( isPasswordReset || isSignIn || isSignUp ) ) return;
                    
                    let
                    
                      ancestorElement,
                      
                      callback = ( mutations ) => {
                      
                        const callback = ( mutation ) => {
                        
                          // bail if attribute not class
                          
                          if ( mutation.attributeName !== 'class' ) return;
                          
                          const
                          
                            element = mutation.target,
                            
                            className = element
                              
                              .getAttribute ( attributeNameClass );
                              
                          // bail if data class attribute is null
                          
                          if ( className === null ) return;
                          
                          const classNames = className
                          
                            .split ( ' ' );
                            
                          for ( const className of classNames ) {
                          
                            const
                            
                              classList = element.classList,
                              
                              b = classList
                              
                                .contains ( className );
                                
                            if ( b ) break; // bail if class already added
                            
                            if ( flDebug )
                            
                              console.log ( className );
                              
                            classList
                            
                              .add ( className );
                              
                            }
                            
                          };
                          
                        mutations.forEach ( callback );
                          
                        },
                        
                      dialogType,
                      
                      element,
                      
                      s,
                      
                      value;
                      
                    const
                    
                      anchorClassAdd = ( key ) => {
                      
                        const
                        
                          selector = `[ href="/account/login/${ key }" ]`,
                          
                          element = node
                          
                            .querySelector ( selector );
                            
                        if ( element )
                        
                          classAdd (
                          
                            element,
                            
                            `${ classPrefix }${ key }-link`
                            
                            );
                            
                        },
                        
                      attributeNameClass = `data-${ codeKey }-class`,
                      
                      classAdd = ( element, classes ) => {
                      
                        const callback = ( clss ) => {
                        
                          if ( flDebug )
                          
                            console.log ( clss );
                            
                          element
                          
                            .classList
                            
                            .add ( clss );
                            
                          };
                          
                        classes
                        
                          .split ( ' ' )
                          
                          .forEach ( callback );
                          
                        },
                        
                      classPrefix = `${ codeKey }-`,
                      
                      classRemove = ( element ) => {
                      
                        const classList = element.classList;
                        
                        for ( const clss of classList ) {
                        
                          const isCodeClass =
                          
                            clss.startsWith ( classPrefix );
                            
                          if ( ! isCodeClass ) continue;
                          
                          classList.remove ( clss );
                          
                          }
                          
                        },
                        
                      config = {
                      
                        attributes : true,
                        
                        subtree : true
                        
                        },
                        
                      observer = new MutationObserver ( callback ),
                      
                      options = twc.calidc,
                      
                      callbacks = options.callbacks,
                      
                      isSignInMemberSite
                      
                        =
                        
                        isSignIn
                        
                        &&
                        
                        !
                        
                        isAccountVerify
                        
                        &&
                        
                        !
                        
                        isSessionExpired
                        
                        &&
                        
                        !!
                        
                        node
                        
                          .querySelector ( 'h3' ),
                          
                      isSignUpMemberSite
                      
                        =
                        
                        isSignUp
                        
                        &&
                        
                        formElement
                        
                          .children
                          
                          .length
                          
                          ===
                          
                          7;
                          
                    // set dialog type
                    
                    {
                    
                      switch ( true ) {
                      
                        case isPasswordReset :
                        
                          dialogType = 'password-reset';
                          
                          break;
                          
                        case isSignIn :
                        
                          dialogType = 'sign-in';
                          
                          break;
                          
                        case isSignUp :
                        
                          dialogType = 'sign-up';
                          
                          break;
                          
                        }
                        
                      switch ( true ) {
                      
                        case isSignInMemberSite :
                        
                          dialogType = 'sign-in-member-site';
                          
                          break;
                          
                        case isSignUpMemberSite :
                        
                          dialogType = 'sign-up-member-site';
                          
                          break;
                          
                        }
                        
                      }
                      
                    // code and dialog type class add
                    
                    {
                    
                      classRemove ( rootElement );
                      
                      classAdd (
                      
                        rootElement,
                        
                        [
                        
                          codeKey,
                          
                          `${ classPrefix }${ dialogType }`
                          
                          ]
                          
                          .join ( ' ' )
                          
                        );
                        
                      }
                      
                    const title = ( ) => {
                    
                      const
                      
                        p = new RegExp ( '^\\[.+\\]$' ),
                        
                        titleElement = node
                        
                          .querySelector ( 'h1' );
                          
                      switch ( true ) {
                      
                        case isPasswordReset :
                        
                          s = options
                          
                            .title
                            
                            .passwordReset;
                            
                          break;
                          
                        case isSignIn :
                        
                          s = options
                          
                            .title
                            
                            .signIn;
                            
                          break;
                          
                        case isSignUp :
                        
                          s = options
                          
                            .title
                            
                            .signUp;
                            
                          break;
                          
                        }
                        
                      if ( isSignInMemberSite || isSignUpMemberSite ) {
                      
                        const wordJoinerCharacter8288
                        
                          =
                          
                          String
                          
                            .fromCharCode ( 8288 );
                            
                        let language = Static
                        
                          .SQUARESPACE_CONTEXT
                          
                          .website
                          
                          .language,
                          
                          re = {
                          
                            'de-DE' : / ^\w+$/,
                            
                            'fi-FI' : /^[^:]+: /,
                            
                            'ja-JP' : new RegExp (
                            
                              `「${ wordJoinerCharacter8288 }|`
                              
                              +
                              
                              `${ wordJoinerCharacter8288 }」.+`,
                              
                              'g'
                              
                              ),
                              
                            default : /^\w+ /
                            
                            };
                            
                        language = Object
                        
                          .hasOwn ( re, language )
                          
                          ? language : 'default';
                          
                        re = re [ language ];
                        
                        const pricingPlanName = titleElement
                        
                          .textContent
                          
                          .replace ( re, '' );
                          
                        const hasPricingPlanName = Object
                        
                          .hasOwn (
                          
                            options
                          
                              .title
                              
                              .pricingPlanNames,
                              
                            pricingPlanName
                            
                            );
                            
                        // bail no pricing plan name
                        
                        if ( ! hasPricingPlanName ) return;
                        
                        s = options
                        
                          .title
                          
                          .pricingPlanNames
                          
                          [ pricingPlanName ];
                          
                        const hasTag = s.includes ( '[ ppn ]' );
                        
                        if ( ! hasTag ) return; // bail it no tag
                        
                        s = s.replace ( '[ ppn ]', pricingPlanName );
                        
                        }
                        
                      const change = ! p.test ( s );
                      
                      if ( change )
                      
                        titleElement
                        
                          .textContent
                          
                          =
                          
                          s;
                          
                      };
                      
                    title ( );
                    
                    // email class add
                    
                    {
                    
                      value = `${ classPrefix }email`;
                      
                      selector = 'input[ type="email" ]';
                      
                      element = formElement
                      
                        .querySelector ( selector );
                        
                      if ( element ) {
                      
                        ancestorElement = element
                        
                          .parentElement
                          
                          .parentElement;
                          
                        classAdd ( ancestorElement, value );
                        
                        ancestorElement
                        
                          .setAttribute ( attributeNameClass, value );
                          
                        }
                        
                      }
                      
                    // password class add
                    
                    {
                    
                      callback = ( element ) => {
                          
                        const
                        
                          dataTest = element
                          
                            .getAttribute ( 'data-test' ),
                            
                          valuePrefix = `${ classPrefix }password`;
                          
                        switch ( dataTest ) {
                        
                          case 'create-account-confirm-password' :
                          
                            value = `${ valuePrefix }-confirm`;
                            
                            break;
                            
                          case 'create-account-password' :
                          case 'login-password' :
                          
                            value = valuePrefix;
                            
                            break;
                            
                          }
                          
                        ancestorElement = element
                        
                          .parentElement
                          
                          .parentElement;
                          
                        classRemove ( ancestorElement );
                        
                        classAdd ( ancestorElement, value );
                        
                        ancestorElement
                        
                          .setAttribute ( attributeNameClass, value );
                          
                        };
                        
                      selector = 'input[ type="password" ]';
                      
                      formElement
                      
                        .querySelectorAll ( selector )
                        
                        .forEach ( callback );
                        
                      }
                      
                    if ( isPasswordReset || isSignUp )
                    
                      // sign in link
                      
                      {
                      
                        selector = '[ href="/account/login" ]';
                        
                        element = node
                        
                          .querySelector ( selector );
                          
                        if ( element )
                        
                          classAdd (
                          
                            element,
                            
                            `${ classPrefix }sign-in-link`
                            
                            );
                            
                        }
                        
                    switch ( true ) {
                    
                      case isSignIn : {
                      
                        const isSignInAgain = node
                        
                          .querySelector ( 'footer' )
                          
                          .children
                          
                          .length
                          
                          ===
                          
                          1;
                            
                        // error class add
                        
                        {
                        
                          const elements = formElement
                            
                            .querySelectorAll ( selector );
                            
                          if ( elements.length )
                          
                            classAdd (
                            
                              [
                              
                                ...
                                
                                elements
                                
                                ]
                                
                                .slice ( -1 )
                                
                                [ 0 ]
                                
                                .parentElement
                                
                                .parentElement
                                
                                .nextElementSibling,
                                
                              `${ classPrefix }error-text`
                                
                              );
                              
                          }
                          
                        if ( ! isSignInAgain ) {
                        
                          anchorClassAdd ( 'request-reset' );
                          
                          anchorClassAdd ( 'create' );
                          
                          // exclusive context text
                          
                          {
                          
                            element = node
                            
                              .querySelector ( 'h3' );
                              
                            if ( element )
                            
                              classAdd (
                              
                                element,
                                
                                `${ classPrefix }exclusive-context-text`
                                
                                );
                                
                            }
                            
                          } else {
                          
                            // sign in again or account verify class add
                            
                            {
                            
                              // text
                              
                              {
                              
                                element = node
                                
                                  .querySelector ( 'h3' );
                                  
                                if ( element ) {
                                
                                  value = classPrefix;
                                  
                                  if ( ! isAccountVerify )
                                  
                                    value += 'again-text';
                                    
                                    else
                                    
                                      value += 'account-verify-text';
                                      
                                  classAdd ( element, value );
                                  
                                  }
                                  
                                }
                                
                              // sign in with email
                              
                              {
                              
                                element = formElement
                                
                                  .querySelector ( 'div:first-child' );
                                  
                                classAdd (
                                
                                  element,
                                  
                                  `${ classPrefix }with-email-text`
                                  
                                  );
                                  
                                }
                                
                              }
                              
                            // not you class add
                            
                            {
                            
                              selector = 'footer [ href="#" ]';
                              
                              element = node
                              
                                .querySelector ( selector );
                                
                              if ( element )
                              
                                classAdd (
                                
                                  element,
                                  
                                  `${ classPrefix }not-you`
                                  
                                  );
                                  
                              }
                              
                            }
                            
                        break;
                        
                        }
                        
                      case isSignUp :
                      
                        // first name class add
                        
                        {
                        
                          value = `${ classPrefix }name-first`;
                          
                          selector = 'input[ type="text" ]' +
                          
                            '[ data-test="create-account-first-name" ]';
                            
                          element = formElement
                          
                            .querySelector ( selector );
                          
                          if ( element ) {
                          
                            ancestorElement = element
                            
                              .parentElement
                              
                              .parentElement;
                              
                            classAdd ( ancestorElement, value );
                            
                            ancestorElement
                            
                              .setAttribute ( attributeNameClass, value );
                              
                            }
                            
                          }
                          
                        // last name class add
                        
                        {
                        
                          value = `${ classPrefix }name-last`;
                          
                          selector = 'input[ type="text" ]' +
                          
                            '[ data-test="create-account-last-name" ]';
                            
                          element = formElement
                          
                            .querySelector ( selector );
                            
                          if ( element ) {
                          
                            ancestorElement = element
                            
                              .parentElement
                              
                              .parentElement;
                              
                            classAdd ( ancestorElement, value );
                            
                            ancestorElement
                            
                              .setAttribute ( attributeNameClass, value );
                              
                            }
                            
                          }
                          
                        // name class add
                        
                        {
                        
                          value = `${ classPrefix }name`;
                          
                          ancestorElement = ancestorElement
                          
                            .parentElement;
                            
                          classAdd ( ancestorElement, value );
                          
                          ancestorElement
                          
                            .setAttribute ( attributeNameClass, value );
                            
                          }
                          
                        // passwords no match
                        
                        {
                        
                          const
                          
                            nodeOriginal = mutation
                            
                              .addedNodes
                              
                              [ 0 ],
                              
                            isPasswordsNotSame = nodeOriginal
                            
                              .previousElementSibling
                              
                              ?.getAttribute ( 'data-test' )
                              
                              ===
                              
                              'create-account-confirm-password';
                              
                          if ( isPasswordsNotSame )
                          
                            classAdd (
                            
                              nodeOriginal,
                              
                              `${ classPrefix }passwords-error-text`
                              
                              );
                              
                          }
                          
                        break;
                        
                      }
                      
                    if ( isSignUpMemberSite ) {
                    
                      isSignUp = false;
                      
                      // sign up member site text class add
                      
                      {
                      
                        element = node
                        
                          .querySelector ( 'h3' );
                          
                        if ( element !== undefined )
                        
                          classAdd (
                          
                            element,
                            
                            `${ classPrefix }unlock-exclusive-content-text`
                            
                            );
                            
                        }
                        
                      // sign up member site emails updates text class add
                      
                      {
                      
                        selector =
                        
                          'button[ data-test="create-account-create-button" ]';
                          
                        classAdd (
                        
                          node
                          
                            .querySelector ( selector )
                            
                            .previousElementSibling
                            
                            .previousElementSibling,
                            
                          `${ classPrefix }emails-updates-text`
                          
                          );
                          
                        }
                        
                      }
                      
                    if ( callbacks.length ) {
                    
                      wrapperObserver.disconnect ( );
                      
                      callback = ( callback ) => {
                      
                        try {
                        
                          callback ( dcmnt, dialogType );
                          
                          } catch ( error ) {
                          
                            const s = `${ codeKey } callback error`;
                            
                            console.error ( s, error );
                            
                            }
                            
                        };
                        
                      callbacks.forEach ( callback );
                      
                      wrapperObserver.observe ( wrapperElement, wrapperConfig );
                      
                      }
                      
                    // start listening for changes in element
                    
                    observer.observe ( formElement, config );
                    
                    },
                    
                  rootElement = dcmnt
                  
                    .querySelector ( `#${ id }` ),
                    
                  wrapperConfig = {
                  
                    characterData : true,
                    
                    childList : true,
                    
                    subtree : true
                    
                    },
                    
                  wrapperElement = rootElement
                  
                    .lastChild,
                    
                  wrapperObserver = new MutationObserver ( callback );
                  
                // css add
                
                {
                
                  const
                  
                    p = new RegExp ( '^\s+\[.+\]\s+$' ),
                    
                    isAdd = ! p.test ( css );
                    
                  if ( isAdd ) {
                  
                    const style = dcmnt
                    
                      .createElement ( 'style' );
                      
                    style.innerHTML = css;
                    
                    dcmnt
                    
                      .body
                      
                      .append ( style );
                      
                    }
                    
                  }
                  
                // make a pass over the panel already on the DOM
                
                {
                
                  const mutation = {
                  
                    addedNodes : [
                    
                      wrapperElement
                      
                      ]
                      
                    };
                    
                  processMutationRecord ( mutation );
                  
                  }
                  
                // start listening for changes in specified element
                
                wrapperObserver.observe ( wrapperElement, wrapperConfig );
                
                },
                
              css = document
              
                .getElementsByTagName ( `x-${ codeKey }-style` )
                
                [ 0 ]
                
                .textContent;
                
            element
            
              .addEventListener ( 'load', callback );
            
            },
            
          observer = new MutationObserver ( callback ),
          
          selector = `#${ accountFrameIdValue }`,
          
          element = document
          
            .querySelector ( selector );
            
        /*
        
          if the account frame is already on the DOM, load. if not, then watch
          for it to appear on DOM and load
          
          */
          
        if ( element ) {
        
          const baseUrl = `${ location.protocol }//${ location.host }`;
          
          let url = element
          
            .getgAttribute ( 'src' );
          
          url = new URL ( url, baseUrl )
          
            .pathname;
            
          const isSignIn = url.startsWith ( '/account/frame' );
          
          if ( isSignIn )
          
            load ( element );
            
          }
          
        // start listening for changes in specified element
        
        observer.observe ( document.body, config );
        
        };
        
      document
      
        .addEventListener ( 'DOMContentLoaded', callback );
        
      } ) ( );
      
    </script>
    
  <!-- end TWC Customer Account Log In Dialog Change -->
